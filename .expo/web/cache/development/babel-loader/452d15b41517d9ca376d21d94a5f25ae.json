{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/run/media/silenttush/Data/WorkSpace/Web Projects/Ad-rebate/Screens/ShareCoupons.js\";\nimport \"react-native-gesture-handler\";\nimport React, { useState, useContext, useEffect } from \"react\";\nimport { Picker } from \"@react-native-picker/picker\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport BackHandler from \"react-native-web/dist/exports/BackHandler\";\nimport Share from \"react-native-web/dist/exports/Share\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport { db } from \"../firebases\";\nimport * as firebase from \"firebase\";\nimport { AuthContext } from \"../routes/AuthProvider\";\nimport { TouchableNativeFeedback } from \"react-native-gesture-handler\";\nimport BannerImages from \"./BannerImages\";\nexport default function ShareCouponScreen(_ref) {\n  var _this = this;\n\n  var navigation = _ref.navigation;\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      phoneNumber = _useState2[0],\n      setPhoneNumber = _useState2[1];\n\n  var _useState3 = useState(true),\n      _useState4 = _slicedToArray(_useState3, 2),\n      disabled = _useState4[0],\n      setDisabled = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      errorText = _useState6[0],\n      setErrorText = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      loading = _useState8[0],\n      setLoading = _useState8[1];\n\n  var _useState9 = useState(null),\n      _useState10 = _slicedToArray(_useState9, 2),\n      selectedCoupon = _useState10[0],\n      setSelectedCoupon = _useState10[1];\n\n  var _useState11 = useState([]),\n      _useState12 = _slicedToArray(_useState11, 2),\n      coupons = _useState12[0],\n      setCoupons = _useState12[1];\n\n  var _useState13 = useState(),\n      _useState14 = _slicedToArray(_useState13, 2),\n      shareUser = _useState14[0],\n      setShareUser = _useState14[1];\n\n  var _useState15 = useState(\"Play Store Link\"),\n      _useState16 = _slicedToArray(_useState15, 2),\n      shareMessage = _useState16[0],\n      setShareMessage = _useState16[1];\n\n  var _useContext = useContext(AuthContext),\n      user = _useContext.user,\n      userData = _useContext.userData;\n\n  useEffect(function () {\n    var backAction = function backAction() {\n      navigation.goBack();\n      return true;\n    };\n\n    var backHandler = BackHandler.addEventListener(\"hardwareBackPress\", backAction);\n    return function () {\n      backHandler.remove();\n    };\n  }, []);\n\n  var checkingPhoneNumber = function checkingPhoneNumber(phoneNumber) {\n    return _regeneratorRuntime.async(function checkingPhoneNumber$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            phoneNumber = phoneNumber.replace(\".\", \"\");\n\n            if (phoneNumber.length != 10 || phoneNumber.length == 0 || isNaN(phoneNumber)) {\n              setPhoneNumber(phoneNumber);\n              setDisabled(true);\n              setErrorText(\"Enter valid 10 digit number\");\n            } else {\n              setPhoneNumber(\"+91\" + phoneNumber);\n              setDisabled(false);\n              setErrorText(null);\n            }\n\n          case 2:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    if (user) {\n      setShareMessage(\"Ad-Rebate\\n\\nReferral Id - \\n\" + user.uid + \"\\n\\nuse this Id to get Coupon\\n\\n\" + \"https://play.google.com/store/apps/details?id=\" + \"appPackageName\");\n    }\n  }, []);\n\n  var onShare = function onShare() {\n    var result;\n    return _regeneratorRuntime.async(function onShare$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(Share.share({\n              message: shareMessage\n            }));\n\n          case 3:\n            result = _context2.sent;\n\n            if (result.action === Share.sharedAction) {\n              if (result.activityType) {} else {}\n            } else if (result.action === Share.dismissedAction) {}\n\n            _context2.next = 10;\n            break;\n\n          case 7:\n            _context2.prev = 7;\n            _context2.t0 = _context2[\"catch\"](0);\n            alert(_context2.t0.message);\n\n          case 10:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 7]], Promise);\n  };\n\n  useEffect(function () {\n    if (user === null) return;\n\n    function temp() {\n      var current, x, d;\n      return _regeneratorRuntime.async(function temp$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              setLoading(true);\n              current = new Date();\n              x = current.getHours() < 10 ? \"0\" : \"\" + current.getHours() + \"-\" + current.getMinutes() < 10 ? \"0\" : \"\" + current.getMinutes();\n              d = (current.getDate() < 10 ? \"0\" : \"\") + current.getDate() + \"-\" + (current.getMonth() + 1 < 10 ? \"0\" : \"\") + (current.getMonth() + 1) + \"-\" + current.getFullYear();\n              db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).where(\"isRedeemed\", \"==\", false).where(\"expiryDateMs\", \">=\", Date.parse(current)).get().then(function (snap) {\n                snap.forEach(function (doc) {\n                  var aa = new Date();\n                  if (doc.data().activeFrom <= Date.parse(aa)) setCoupons(function (prev) {\n                    return [].concat(_toConsumableArray(prev), [doc.data()]);\n                  });\n                });\n              }).then(function () {\n                setLoading(false);\n              }).catch(function (err) {\n                console.log(err);\n              });\n\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n\n    temp();\n  }, [user]);\n  useEffect(function () {\n    if (coupons.length < 1) {\n      return;\n    }\n\n    setSelectedCoupon(coupons[0]);\n  }, [coupons]);\n\n  var shareCouponChecking = function shareCouponChecking() {\n    var tempUser;\n    return _regeneratorRuntime.async(function shareCouponChecking$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            if (coupons != null) {\n              tempUser = [];\n              db.collection(\"Users\").where(\"phone\", \"==\", phoneNumber).get().then(function (res) {\n                res.forEach(function (user) {\n                  tempUser.push(user.data());\n                });\n                console.log(tempUser);\n              }).then(function () {\n                db.collection(\"ClientData\").doc(selectedCoupon.client).collection(\"Coupons\").doc(selectedCoupon.id).set({\n                  allotedTo: tempUser[0].id\n                }, {\n                  merge: true\n                }).then(db.collection(\"Users\").doc(tempUser[0].id).set({\n                  couponsReceived: firebase.firestore.FieldValue.arrayUnion(userData.username)\n                }, {\n                  merge: true\n                }).then(function _callee() {\n                  var schedulePushNotification;\n                  return _regeneratorRuntime.async(function _callee$(_context5) {\n                    while (1) {\n                      switch (_context5.prev = _context5.next) {\n                        case 0:\n                          schedulePushNotification = function _schedulePushNotifica() {\n                            return _regeneratorRuntime.async(function schedulePushNotification$(_context4) {\n                              while (1) {\n                                switch (_context4.prev = _context4.next) {\n                                  case 0:\n                                    _context4.next = 2;\n                                    return _regeneratorRuntime.awrap(Notifications.scheduleNotificationAsync({\n                                      content: {\n                                        title: \"You've got mail! ðŸ“¬\",\n                                        body: \"Here is the notification body\",\n                                        data: {\n                                          data: \"goes here\"\n                                        }\n                                      },\n                                      trigger: {\n                                        seconds: 2\n                                      }\n                                    }));\n\n                                  case 2:\n                                  case \"end\":\n                                    return _context4.stop();\n                                }\n                              }\n                            }, null, null, null, Promise);\n                          };\n\n                          _context5.next = 3;\n                          return _regeneratorRuntime.awrap(fetch(\"https://fcm.googleapis.com/fcm/send\", {\n                            method: \"POST\",\n                            headers: {\n                              \"Content-Type\": \"application/json\",\n                              Authorization: \"AAAANh_mSWs:APA91bEdCYWZPoMDegvvhriAANzbpHjsknyxR8V7UggP7F3GNigmlmV-LRdgAlfC7w6jbhEBxnqZ93DkM-QeoZQ9d2k4ycGF8dZzYxWOCRfseeJor8GNl97qqIOtG9jSTJH2kXYc4VXF\"\n                            },\n                            body: JSON.stringify({\n                              to: tempUser[0].expoToken,\n                              priority: \"normal\",\n                              data: {\n                                experienceId: \"@adrebateadmin/ad-rebate-app-new\",\n                                title: userData.username,\n                                message: \"Hello world!\"\n                              }\n                            })\n                          }));\n\n                        case 3:\n                          (function () {\n                            return navigation.popToTop();\n                          }), console.log(\"done\"), Alert.alert(\"Coupon Shared\");\n\n                        case 4:\n                        case \"end\":\n                          return _context5.stop();\n                      }\n                    }\n                  }, null, null, null, Promise);\n                }).catch(function (err) {\n                  console.log(err);\n                })).catch(function (err) {\n                  console.log(err);\n                });\n              }).catch(function (error) {\n                Alert.alert(\"Not a Valid user in Ad-Rebate\");\n                console.log(\"Not a valid User \", error);\n              });\n            }\n\n          case 1:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 5\n    }\n  }, React.createElement(StatusBar, {\n    backgroundColor: \"black\",\n    barStyle: \"light-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    style: styles.banner,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 7\n    }\n  }, React.createElement(BannerImages, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 9\n    }\n  })), React.createElement(TextInput, {\n    style: styles.textinput,\n    placeholder: \"Enter phone no.\",\n    placeholderTextColor: \"#EDEDED\",\n    keyboardAppearance: \"dark\",\n    keyboardType: \"phone-pad\",\n    color: \"#fff\",\n    onChangeText: checkingPhoneNumber,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 7\n    }\n  }), React.createElement(Text, {\n    style: styles.erText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 8\n    }\n  }, errorText), loading ? React.createElement(View, {\n    style: [styles.picker, {\n      justifyContent: \"center\",\n      paddingTop: 2,\n      paddingRight: 30,\n      flexDirection: \"row\",\n      alignItems: \"center\"\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    style: styles.gtt,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 11\n    }\n  }, \"Getting your coupons..\"), React.createElement(ActivityIndicator, {\n    color: \"white\",\n    size: \"small\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 11\n    }\n  })) : coupons.length > 0 ? React.createElement(View, {\n    style: styles.picker,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 9\n    }\n  }, React.createElement(Picker, {\n    style: {\n      color: \"white\",\n      fontSize: 12\n    },\n    dropdownIconColor: \"gray\",\n    onValueChange: function onValueChange(itemValue, itemIndex) {\n      console.log(\"ote,\" + itemValue);\n      setSelectedCoupon(itemValue);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 11\n    }\n  }, coupons.map(function (item) {\n    return React.createElement(Picker.Item, {\n      style: styles.pickerItem,\n      label: item.clientName + \" - discount upto : \" + item.userDiscount5 + \"%\",\n      value: item,\n      key: item.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 17\n      }\n    });\n  }))) : React.createElement(View, {\n    style: styles.erText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    style: {\n      color: \"#ff6d6d\",\n      fontFamily: \"Poppins-Regular\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 11\n    }\n  }, \"You do not have any coupon.\")), React.createElement(TouchableNativeFeedback, {\n    onPress: shareCouponChecking,\n    disabled: disabled,\n    style: styles.button,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    style: styles.buttonText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 9\n    }\n  }, \"Share\")));\n}\nvar styles = StyleSheet.create({\n  banner: {\n    height: \"20%\",\n    marginTop: 5,\n    width: \"90%\",\n    alignItems: \"center\",\n    alignSelf: \"center\",\n    marginBottom: \"2%\"\n  },\n  buttonText: {\n    color: \"#fff\",\n    width: \"100%\",\n    textAlign: \"center\",\n    fontSize: 16,\n    fontFamily: \"Poppins-Regular\"\n  },\n  gtt: {\n    color: \"#fff\",\n    marginRight: 10,\n    fontSize: 16,\n    fontFamily: \"Poppins-Regular\"\n  },\n  button: {\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    alignSelf: \"center\",\n    width: 150,\n    borderRadius: 20,\n    marginBottom: 50,\n    height: 58,\n    borderColor: \"#fff\",\n    borderStyle: \"solid\",\n    borderWidth: 1\n  },\n  textinput: {\n    marginTop: 150,\n    backgroundColor: \"#1A1A1A\",\n    borderColor: \"#424242\",\n    borderWidth: 1,\n    borderRadius: 20,\n    paddingLeft: 20,\n    paddingRight: 20,\n    width: \"80%\",\n    height: 61,\n    alignSelf: \"center\",\n    fontSize: 18,\n    fontFamily: \"Poppins-Regular\",\n    marginBottom: 24\n  },\n  erText: {\n    color: \"#ff7474\",\n    width: \"75%\",\n    fontFamily: \"Poppins-Regular\",\n    height: 40,\n    textAlign: \"center\",\n    alignSelf: \"center\",\n    marginTop: -10\n  },\n  picker: {\n    backgroundColor: \"#1A1A1A\",\n    borderColor: \"#424242\",\n    color: \"#f3f3f3\",\n    borderWidth: 1,\n    borderRadius: 20,\n    paddingLeft: 20,\n    paddingTop: 5,\n    width: \"80%\",\n    height: 61,\n    alignSelf: \"center\",\n    fontSize: 12,\n    fontFamily: \"Poppins-Regular\",\n    marginBottom: 24\n  },\n  pickerItem: {\n    color: \"white\",\n    fontFamily: \"Poppins-Regular\",\n    backgroundColor: \"#252525\",\n    borderRadius: 10,\n    width: \"80%\",\n    height: 50,\n    textAlign: \"center\",\n    marginBottom: 10\n  },\n  container: {\n    backgroundColor: \"black\",\n    height: \"100%\"\n  }\n});","map":{"version":3,"sources":["/run/media/silenttush/Data/WorkSpace/Web Projects/Ad-rebate/Screens/ShareCoupons.js"],"names":["React","useState","useContext","useEffect","Picker","db","firebase","AuthContext","TouchableNativeFeedback","BannerImages","ShareCouponScreen","navigation","phoneNumber","setPhoneNumber","disabled","setDisabled","errorText","setErrorText","loading","setLoading","selectedCoupon","setSelectedCoupon","coupons","setCoupons","shareUser","setShareUser","shareMessage","setShareMessage","user","userData","backAction","goBack","backHandler","BackHandler","addEventListener","remove","checkingPhoneNumber","replace","length","isNaN","uid","onShare","Share","share","message","result","action","sharedAction","activityType","dismissedAction","alert","temp","current","Date","x","getHours","getMinutes","d","getDate","getMonth","getFullYear","collectionGroup","where","parse","get","then","snap","forEach","doc","aa","data","activeFrom","prev","catch","err","console","log","shareCouponChecking","tempUser","collection","res","push","client","id","set","allotedTo","merge","couponsReceived","firestore","FieldValue","arrayUnion","username","schedulePushNotification","Notifications","scheduleNotificationAsync","content","title","body","trigger","seconds","fetch","method","headers","Authorization","JSON","stringify","to","expoToken","priority","experienceId","popToTop","Alert","error","styles","container","banner","textinput","erText","picker","justifyContent","paddingTop","paddingRight","flexDirection","alignItems","gtt","color","fontSize","itemValue","itemIndex","map","item","pickerItem","clientName","userDiscount5","fontFamily","button","buttonText","StyleSheet","create","height","marginTop","width","alignSelf","marginBottom","textAlign","marginRight","borderRadius","borderColor","borderStyle","borderWidth","backgroundColor","paddingLeft"],"mappings":"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","sourcesContent":["import \"react-native-gesture-handler\";\r\nimport React, { useState, useContext, useEffect } from \"react\";\r\nimport { Picker } from \"@react-native-picker/picker\";\r\nimport {\r\n  Button,\r\n  View,\r\n  Text,\r\n  TextInput,\r\n  StyleSheet,\r\n  StatusBar,\r\n  Alert,\r\n  BackHandler,\r\n  Share,\r\n  ActivityIndicator,\r\n} from \"react-native\";\r\nimport { db } from \"../firebases\";\r\nimport * as firebase from \"firebase\";\r\nimport { AuthContext } from \"../routes/AuthProvider\";\r\nimport { TouchableNativeFeedback } from \"react-native-gesture-handler\";\r\nimport BannerImages from \"./BannerImages\";\r\n\r\nexport default function ShareCouponScreen({ navigation }) {\r\n  const [phoneNumber, setPhoneNumber] = useState();\r\n  const [disabled, setDisabled] = useState(true);\r\n  const [errorText, setErrorText] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [selectedCoupon, setSelectedCoupon] = useState(null);\r\n  const [coupons, setCoupons] = useState([]);\r\n  const [shareUser, setShareUser] = useState();\r\n  const [shareMessage, setShareMessage] = useState(\"Play Store Link\");\r\n  const { user, userData } = useContext(AuthContext);\r\n\r\n  useEffect(() => {\r\n    const backAction = () => {\r\n      navigation.goBack();\r\n      return true;\r\n    };\r\n    const backHandler = BackHandler.addEventListener(\r\n      \"hardwareBackPress\",\r\n      backAction\r\n    );\r\n    return () => {\r\n      backHandler.remove();\r\n    };\r\n  }, []);\r\n\r\n  const checkingPhoneNumber = async (phoneNumber) => {\r\n    phoneNumber = phoneNumber.replace(\".\", \"\");\r\n    if (\r\n      phoneNumber.length != 10 ||\r\n      phoneNumber.length == 0 ||\r\n      isNaN(phoneNumber)\r\n    ) {\r\n      setPhoneNumber(phoneNumber);\r\n      setDisabled(true);\r\n      setErrorText(\"Enter valid 10 digit number\");\r\n    } else {\r\n      setPhoneNumber(\"+91\" + phoneNumber);\r\n      setDisabled(false);\r\n      setErrorText(null);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      setShareMessage(\r\n        \"Ad-Rebate\\n\\nReferral Id - \\n\" +\r\n          user.uid +\r\n          \"\\n\\nuse this Id to get Coupon\\n\\n\" +\r\n          \"https://play.google.com/store/apps/details?id=\" +\r\n          \"appPackageName\"\r\n      );\r\n    }\r\n  }, []);\r\n  const onShare = async () => {\r\n    try {\r\n      const result = await Share.share({\r\n        message: shareMessage,\r\n      });\r\n      if (result.action === Share.sharedAction) {\r\n        if (result.activityType) {\r\n          // shared with activity type of result.activityType\r\n        } else {\r\n          // shared\r\n        }\r\n      } else if (result.action === Share.dismissedAction) {\r\n        // dismissed\r\n      }\r\n    } catch (error) {\r\n      alert(error.message);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (user === null) return;\r\n    async function temp() {\r\n      setLoading(true);\r\n      var current = new Date();\r\n      const x =\r\n        current.getHours() < 10\r\n          ? \"0\"\r\n          : \"\" + current.getHours() + \"-\" + current.getMinutes() < 10\r\n          ? \"0\"\r\n          : \"\" + current.getMinutes();\r\n      //console.log(x);\r\n      const d =\r\n        (current.getDate() < 10 ? \"0\" : \"\") +\r\n        current.getDate() +\r\n        \"-\" +\r\n        (current.getMonth() + 1 < 10 ? \"0\" : \"\") +\r\n        (current.getMonth() + 1) +\r\n        \"-\" +\r\n        current.getFullYear();\r\n      db.collectionGroup(\"Coupons\")\r\n        .where(\"allotedTo\", \"==\", user.uid)\r\n        .where(\"isRedeemed\", \"==\", false)\r\n        .where(\"expiryDateMs\", \">=\", Date.parse(current))\r\n        .get()\r\n        .then((snap) => {\r\n          snap.forEach((doc) => {\r\n            var aa = new Date();\r\n            if (doc.data().activeFrom <= Date.parse(aa))\r\n              setCoupons((prev) => [...prev, doc.data()]);\r\n          });\r\n        })\r\n        .then(() => {\r\n          setLoading(false);\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n    }\r\n    temp();\r\n  }, [user]);\r\n\r\n  useEffect(() => {\r\n    if (coupons.length < 1) {\r\n      return;\r\n    }\r\n    //console.log(\"ccc\");\r\n    //console.log(coupons);\r\n    setSelectedCoupon(coupons[0]);\r\n  }, [coupons]);\r\n\r\n  //console.log(coupons);\r\n  const shareCouponChecking = async () => {\r\n    if (coupons != null) {\r\n      const tempUser = [];\r\n      db.collection(\"Users\")\r\n        .where(\"phone\", \"==\", phoneNumber)\r\n        .get()\r\n        .then((res) => {\r\n          res.forEach((user) => {\r\n            tempUser.push(user.data());\r\n          });\r\n          console.log(tempUser);\r\n          //console.log(selectedCoupon);\r\n        })\r\n        .then(() => {\r\n          //console.log(userData.username);\r\n          db.collection(\"ClientData\")\r\n            .doc(selectedCoupon.client)\r\n            .collection(\"Coupons\")\r\n            .doc(selectedCoupon.id)\r\n            .set({ allotedTo: tempUser[0].id }, { merge: true })\r\n            .then(\r\n              db\r\n                .collection(\"Users\")\r\n                .doc(tempUser[0].id)\r\n                .set(\r\n                  {\r\n                    couponsReceived: firebase.firestore.FieldValue.arrayUnion(\r\n                      userData.username\r\n                    ),\r\n                  },\r\n                  { merge: true }\r\n                )\r\n                .then(async () => {\r\n                  async function schedulePushNotification() {\r\n                    await Notifications.scheduleNotificationAsync({\r\n                      content: {\r\n                        title: \"You've got mail! ðŸ“¬\",\r\n                        body: \"Here is the notification body\",\r\n                        data: { data: \"goes here\" },\r\n                      },\r\n                      trigger: { seconds: 2 },\r\n                    });\r\n                  }\r\n                  await fetch(\"https://fcm.googleapis.com/fcm/send\", {\r\n                    method: \"POST\",\r\n                    headers: {\r\n                      \"Content-Type\": \"application/json\",\r\n                      Authorization: `AAAANh_mSWs:APA91bEdCYWZPoMDegvvhriAANzbpHjsknyxR8V7UggP7F3GNigmlmV-LRdgAlfC7w6jbhEBxnqZ93DkM-QeoZQ9d2k4ycGF8dZzYxWOCRfseeJor8GNl97qqIOtG9jSTJH2kXYc4VXF`,\r\n                    },\r\n                    body: JSON.stringify({\r\n                      to: tempUser[0].expoToken,\r\n                      priority: \"normal\",\r\n                      data: {\r\n                        experienceId: \"@adrebateadmin/ad-rebate-app-new\",\r\n                        title: userData.username,\r\n                        message: \"Hello world!\",\r\n                      },\r\n                    }),\r\n                  });\r\n                  () => navigation.popToTop(),\r\n                    console.log(\"done\"),\r\n                    Alert.alert(\"Coupon Shared\");\r\n                })\r\n                .catch((err) => {\r\n                  console.log(err);\r\n                })\r\n            )\r\n            .catch((err) => {\r\n              console.log(err);\r\n            });\r\n        })\r\n\r\n        .catch(function (error) {\r\n          Alert.alert(\"Not a Valid user in Ad-Rebate\");\r\n          console.log(\"Not a valid User \", error);\r\n        });\r\n    }\r\n  };\r\n  return (\r\n    <View style={styles.container}>\r\n      <StatusBar backgroundColor=\"black\" barStyle=\"light-content\" />\r\n      <View style={styles.banner}>\r\n        <BannerImages />\r\n      </View>\r\n      <TextInput\r\n        style={styles.textinput}\r\n        placeholder=\"Enter phone no.\"\r\n        placeholderTextColor=\"#EDEDED\"\r\n        keyboardAppearance=\"dark\"\r\n        keyboardType=\"phone-pad\"\r\n        color=\"#fff\"\r\n        onChangeText={checkingPhoneNumber}\r\n      ></TextInput>\r\n      {<Text style={styles.erText}>{errorText}</Text>}\r\n      {loading ? (\r\n        <View\r\n          style={[\r\n            styles.picker,\r\n            {\r\n              justifyContent: \"center\",\r\n              paddingTop: 2,\r\n              paddingRight: 30,\r\n              flexDirection: \"row\",\r\n              alignItems: \"center\",\r\n            },\r\n          ]}\r\n        >\r\n          <Text style={styles.gtt}>Getting your coupons..</Text>\r\n          <ActivityIndicator color=\"white\" size=\"small\"></ActivityIndicator>\r\n        </View>\r\n      ) : coupons.length > 0 ? (\r\n        <View style={styles.picker}>\r\n          <Picker\r\n            style={{\r\n              color: \"white\",\r\n              fontSize: 12,\r\n            }}\r\n            dropdownIconColor=\"gray\"\r\n            onValueChange={(itemValue, itemIndex) => {\r\n              console.log(\"ote,\" + itemValue);\r\n              setSelectedCoupon(itemValue);\r\n            }}\r\n          >\r\n            {coupons.map((item) => {\r\n              return (\r\n                <Picker.Item\r\n                  style={styles.pickerItem}\r\n                  label={\r\n                    item.clientName +\r\n                    \" - discount upto : \" +\r\n                    item.userDiscount5 +\r\n                    \"%\"\r\n                  }\r\n                  value={item}\r\n                  key={item.id}\r\n                />\r\n              );\r\n            })}\r\n          </Picker>\r\n        </View>\r\n      ) : (\r\n        <View style={styles.erText}>\r\n          <Text style={{ color: \"#ff6d6d\", fontFamily: \"Poppins-Regular\" }}>\r\n            You do not have any coupon.\r\n          </Text>\r\n        </View>\r\n      )}\r\n      <TouchableNativeFeedback\r\n        onPress={shareCouponChecking}\r\n        disabled={disabled}\r\n        style={styles.button}\r\n      >\r\n        <Text style={styles.buttonText}>Share</Text>\r\n      </TouchableNativeFeedback>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  banner: {\r\n    height: \"20%\",\r\n    marginTop: 5,\r\n    width: \"90%\",\r\n    alignItems: \"center\",\r\n    alignSelf: \"center\",\r\n    marginBottom: \"2%\",\r\n  },\r\n  buttonText: {\r\n    color: \"#fff\",\r\n    width: \"100%\",\r\n    textAlign: \"center\",\r\n    fontSize: 16,\r\n    fontFamily: \"Poppins-Regular\",\r\n  },\r\n  gtt: {\r\n    color: \"#fff\",\r\n    marginRight: 10,\r\n    fontSize: 16,\r\n    fontFamily: \"Poppins-Regular\",\r\n  },\r\n  button: {\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    alignSelf: \"center\",\r\n    width: 150,\r\n    borderRadius: 20,\r\n    marginBottom: 50,\r\n    height: 58,\r\n    borderColor: \"#fff\",\r\n    borderStyle: \"solid\",\r\n    borderWidth: 1,\r\n  },\r\n  textinput: {\r\n    marginTop: 150,\r\n    backgroundColor: \"#1A1A1A\",\r\n    borderColor: \"#424242\",\r\n    borderWidth: 1,\r\n    borderRadius: 20,\r\n    paddingLeft: 20,\r\n    paddingRight: 20,\r\n    width: \"80%\",\r\n    height: 61,\r\n    alignSelf: \"center\",\r\n    fontSize: 18,\r\n    fontFamily: \"Poppins-Regular\",\r\n    marginBottom: 24,\r\n  },\r\n  erText: {\r\n    color: \"#ff7474\",\r\n    width: \"75%\",\r\n    fontFamily: \"Poppins-Regular\",\r\n    height: 40,\r\n    textAlign: \"center\",\r\n    alignSelf: \"center\",\r\n    marginTop: -10,\r\n  },\r\n  picker: {\r\n    backgroundColor: \"#1A1A1A\",\r\n    borderColor: \"#424242\",\r\n    color: \"#f3f3f3\",\r\n    borderWidth: 1,\r\n    borderRadius: 20,\r\n    paddingLeft: 20,\r\n    paddingTop: 5,\r\n    width: \"80%\",\r\n    height: 61,\r\n    alignSelf: \"center\",\r\n    fontSize: 12,\r\n    fontFamily: \"Poppins-Regular\",\r\n    marginBottom: 24,\r\n  },\r\n  pickerItem: {\r\n    color: \"white\",\r\n    fontFamily: \"Poppins-Regular\",\r\n    backgroundColor: \"#252525\",\r\n    borderRadius: 10,\r\n    width: \"80%\",\r\n    height: 50,\r\n    textAlign: \"center\",\r\n    marginBottom: 10,\r\n  },\r\n  container: {\r\n    backgroundColor: \"black\",\r\n    height: \"100%\",\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}