{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"D:\\\\WorkSpace\\\\Web Projects\\\\Ad-rebate\\\\Screens\\\\GetCoupon.js\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport BackHandler from \"react-native-web/dist/exports/BackHandler\";\nimport { db } from \"../firebases\";\nimport { AuthContext } from \"../routes/AuthProvider\";\nimport * as firebase from \"firebase\";\nexport default function GetCoupon(_ref) {\n  var navigation = _ref.navigation,\n      route = _ref.route;\n  var id = \"chocolateStoryBhilai\";\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      coupon = _useState2[0],\n      setCoupon = _useState2[1];\n\n  var _useContext = useContext(AuthContext),\n      user = _useContext.user,\n      setUserData = _useContext.setUserData,\n      setBannerData = _useContext.setBannerData,\n      userData = _useContext.userData;\n\n  BackHandler.addEventListener(\"hardwareBackPress\", function () {\n    navigation.popToTop();\n    return true;\n  });\n  useEffect(function () {\n    var xx = {};\n\n    function xxx() {\n      return _regeneratorRuntime.async(function xxx$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              db.collection(\"ClientData\").doc(id).collection(\"Coupons\").where(\"isAlloted\", \"==\", false).limit(1).get().then(function (querySnapshot) {\n                querySnapshot.forEach(function (doc) {\n                  xx = doc.data();\n                  console.log(xx);\n                });\n              }).then(function () {\n                var current = new Date();\n                current.setHours(current.getHours() + 1);\n                var x = (current.getHours() < 10 ? \"0\" : \"\") + current.getHours() + \"-\" + (current.getMinutes() < 10 ? \"0\" : \"\") + current.getMinutes();\n                var d = (current.getDate() < 10 ? \"0\" : \"\") + current.getDate() + \"-\" + (current.getMonth() + 1 < 10 ? \"0\" : \"\") + (current.getMonth() + 1) + \"-\" + current.getFullYear();\n                xx.activeFrom = Date.parse(current);\n                xx.activeFromTime = x;\n                xx.activeFromDate = d;\n                xx.isAlloted = true;\n                xx.allotedTo = user.uid;\n                setCoupon(xx);\n                console.log(\"done\");\n                db.collection(\"ClientData\").doc(id).collection(\"Coupons\").doc(xx.id).set(xx).then(function () {\n                  return console.log(\"done\");\n                }).catch(function (err) {\n                  console.log(err);\n                });\n              }).catch(function (error) {\n                console.log(\"Error getting documents: \", error);\n              });\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n\n    xxx();\n  }, []);\n  return React.createElement(View, {\n    style: styles.page,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 5\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }\n  }, coupon ? coupon.id : \"loading\"), React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }\n  }, coupon ? React.createElement(View, {\n    style: styles.coupon,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    style: styles.couponText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }\n  }, coupon.id), React.createElement(Text, {\n    style: styles.couponText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }\n  }, coupon.discount1), React.createElement(Text, {\n    style: styles.couponText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 13\n    }\n  }, coupon.expiryDate), React.createElement(View, {\n    style: styles.activeDate,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    style: styles.couponText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 15\n    }\n  }, coupon.activeFromDate), React.createElement(Text, {\n    style: styles.couponText,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 15\n    }\n  }, coupon.activeFromTime))) : React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }\n  }, \"loading\"))), React.createElement(Button, {\n    title: \"Go Home\",\n    onPress: function onPress() {\n      return navigation.popToTop();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }\n  }));\n}\nvar styles = StyleSheet.create({\n  activeDate: {\n    flexDirection: \"row\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    width: \"60%\",\n    height: 200\n  },\n  page: {\n    backgroundColor: \"black\",\n    justifyContent: \"center\"\n  },\n  coupon: {\n    borderRadius: 20,\n    width: \"60%\",\n    height: 200,\n    marginTop: 100,\n    color: \"white\",\n    borderRadius: 20,\n    backgroundColor: \"#000\",\n    padding: 20\n  },\n  couponText: {\n    color: \"#a0a0a0\"\n  },\n  container: {\n    flex: 1,\n    alignItems: \"center\"\n  }\n});","map":{"version":3,"sources":["D:/WorkSpace/Web Projects/Ad-rebate/Screens/GetCoupon.js"],"names":["React","useContext","useEffect","useState","db","AuthContext","firebase","GetCoupon","navigation","route","id","coupon","setCoupon","user","setUserData","setBannerData","userData","BackHandler","addEventListener","popToTop","xx","xxx","collection","doc","where","limit","get","then","querySnapshot","forEach","data","console","log","current","Date","setHours","getHours","x","getMinutes","d","getDate","getMonth","getFullYear","activeFrom","parse","activeFromTime","activeFromDate","isAlloted","allotedTo","uid","set","catch","err","error","styles","page","container","couponText","discount1","expiryDate","activeDate","StyleSheet","create","flexDirection","justifyContent","alignItems","width","height","backgroundColor","borderRadius","marginTop","color","padding","flex"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\r\nimport {\r\n  View,\r\n  Text,\r\n  Button,\r\n  StyleSheet,\r\n  Dimensions,\r\n  BackHandler,\r\n} from \"react-native\";\r\nimport { db } from \"../firebases\";\r\nimport { AuthContext } from \"../routes/AuthProvider\";\r\nimport * as firebase from \"firebase\";\r\nexport default function GetCoupon({ navigation, route }) {\r\n  //const id = route.params.paramKey;\r\n  const id = \"chocolateStoryBhilai\";\r\n  const [coupon, setCoupon] = useState(null);\r\n\r\n  const { user, setUserData, setBannerData, userData } = useContext(\r\n    AuthContext\r\n  );\r\n  BackHandler.addEventListener(\"hardwareBackPress\", function () {\r\n    navigation.popToTop();\r\n    return true;\r\n  });\r\n  useEffect(() => {\r\n    let xx = {};\r\n    async function xxx() {\r\n      db.collection(\"ClientData\")\r\n        .doc(id)\r\n        .collection(\"Coupons\")\r\n        .where(\"isAlloted\", \"==\", false)\r\n        .limit(1)\r\n        .get()\r\n        .then(function (querySnapshot) {\r\n          querySnapshot.forEach(function (doc) {\r\n            // doc.data() is never undefined for query doc snapshots\r\n            xx = doc.data();\r\n            console.log(xx);\r\n          });\r\n        })\r\n        .then(() => {\r\n          var current = new Date();\r\n          current.setHours(current.getHours() + 1);\r\n          const x =\r\n            (current.getHours() < 10 ? \"0\" : \"\") +\r\n            current.getHours() +\r\n            \"-\" +\r\n            (current.getMinutes() < 10 ? \"0\" : \"\") +\r\n            current.getMinutes();\r\n          const d =\r\n            (current.getDate() < 10 ? \"0\" : \"\") +\r\n            current.getDate() +\r\n            \"-\" +\r\n            (current.getMonth() + 1 < 10 ? \"0\" : \"\") +\r\n            (current.getMonth() + 1) +\r\n            \"-\" +\r\n            current.getFullYear();\r\n          xx.activeFrom = Date.parse(current);\r\n          xx.activeFromTime = x;\r\n          xx.activeFromDate = d;\r\n          xx.isAlloted = true;\r\n          xx.allotedTo = user.uid;\r\n          setCoupon(xx);\r\n          console.log(\"done\");\r\n\r\n          db.collection(\"ClientData\")\r\n            .doc(id)\r\n            .collection(\"Coupons\")\r\n            .doc(xx.id)\r\n            .set(xx)\r\n            .then(() => console.log(\"done\"))\r\n            .catch((err) => {\r\n              console.log(err);\r\n            });\r\n        })\r\n        .catch(function (error) {\r\n          console.log(\"Error getting documents: \", error);\r\n        });\r\n    }\r\n    xxx();\r\n  }, []);\r\n\r\n  return (\r\n    <View style={styles.page}>\r\n      <Text>{coupon ? coupon.id : \"loading\"}</Text>\r\n      <View style={styles.container}>\r\n        {coupon ? (\r\n          <View style={styles.coupon}>\r\n            <Text style={styles.couponText}>{coupon.id}</Text>\r\n            <Text style={styles.couponText}>{coupon.discount1}</Text>\r\n            <Text style={styles.couponText}>{coupon.expiryDate}</Text>\r\n            <View style={styles.activeDate}>\r\n              <Text style={styles.couponText}>{coupon.activeFromDate}</Text>\r\n              <Text style={styles.couponText}>{coupon.activeFromTime}</Text>\r\n            </View>\r\n          </View>\r\n        ) : (\r\n          <View>\r\n            <Text>loading</Text>\r\n          </View>\r\n        )}\r\n      </View>\r\n      <Button title=\"Go Home\" onPress={() => navigation.popToTop()} />\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  activeDate: {\r\n    flexDirection: \"row\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    width: \"60%\",\r\n    height: 200,\r\n  },\r\n  page: {\r\n    backgroundColor: \"black\",\r\n    justifyContent: \"center\",\r\n  },\r\n  coupon: {\r\n    borderRadius: 20,\r\n    width: \"60%\",\r\n    height: 200,\r\n    marginTop: 100,\r\n    color: \"white\",\r\n    borderRadius: 20,\r\n    backgroundColor: \"#000\",\r\n    padding: 20,\r\n  },\r\n  couponText: {\r\n    color: \"#a0a0a0\",\r\n  },\r\n  container: {\r\n    flex: 1,\r\n    alignItems: \"center\",\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}