{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"D:\\\\WorkSpace\\\\Web Projects\\\\Ad-rebate\\\\Screens\\\\Coupon.js\";\nimport \"react-native-gesture-handler\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport { db } from \"../firebases\";\nimport { AuthContext } from \"../routes/AuthProvider\";\nimport { FlatList } from \"react-native-gesture-handler\";\nimport test from \"../assets/images/test.jpg\";\nexport default function CouponScreen(_ref) {\n  var _this = this;\n\n  var navigation = _ref.navigation;\n\n  var _useContext = useContext(AuthContext),\n      user = _useContext.user;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      couponArray = _useState2[0],\n      setCouponArray = _useState2[1];\n\n  var _useState3 = useState(\"active\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      currentOption = _useState4[0],\n      setcurrentOption = _useState4[1];\n\n  useEffect(function () {\n    if (user) {\n      var current = new Date();\n      db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).where(\"isRedeemed\", \"==\", false).where(\"expiryDateMs\", \">=\", Date.parse(current)).get().then(function (snap) {\n        snap.forEach(function (doc) {\n          var aa = new Date();\n          if (doc.data().activeFrom <= Date.parse(aa)) setCouponArray(function (prev) {\n            return [].concat(_toConsumableArray(prev), [doc.data()]);\n          });\n        });\n      });\n    }\n  }, [user]);\n\n  function getActiveCoupons() {\n    var current;\n    return _regeneratorRuntime.async(function getActiveCoupons$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!(currentOption === \"active\")) {\n              _context.next = 2;\n              break;\n            }\n\n            return _context.abrupt(\"return\");\n\n          case 2:\n            setCouponArray([]);\n            current = new Date();\n            db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).where(\"isRedeemed\", \"==\", false).where(\"expiryDateMs\", \">=\", Date.parse(current)).get().then(function (snap) {\n              snap.forEach(function (doc) {\n                if (doc.data().activeFrom <= Date.parse(current)) setCouponArray(function (prev) {\n                  return [].concat(_toConsumableArray(prev), [doc.data()]);\n                });\n              });\n            });\n\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  function getExpiredCoupons() {\n    var current;\n    return _regeneratorRuntime.async(function getExpiredCoupons$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (!(currentOption === \"expired\")) {\n              _context2.next = 2;\n              break;\n            }\n\n            return _context2.abrupt(\"return\");\n\n          case 2:\n            current = new Date();\n            setCouponArray([]);\n            db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).where(\"isRedeemed\", \"==\", false).get().then(function (snap) {\n              snap.forEach(function (doc) {\n                var x = [];\n                x.push(doc.data());\n                if (doc.data().expiryDate <= Date.parse(current)) setCouponArray(function (prev) {\n                  return [].concat(_toConsumableArray(prev), [doc.data()]);\n                });\n              });\n            });\n\n          case 5:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  function getAllCoupons() {\n    return _regeneratorRuntime.async(function getAllCoupons$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            if (!(currentOption === \"all\")) {\n              _context3.next = 2;\n              break;\n            }\n\n            return _context3.abrupt(\"return\");\n\n          case 2:\n            setCouponArray([]);\n            db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).get().then(function (snap) {\n              snap.forEach(function (doc) {\n                setCouponArray(function (prev) {\n                  return [].concat(_toConsumableArray(prev), [doc.data()]);\n                });\n              });\n            });\n\n          case 4:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  function getRedeemedCoupons() {\n    return _regeneratorRuntime.async(function getRedeemedCoupons$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            if (!(currentOption === \"redeemed\")) {\n              _context4.next = 2;\n              break;\n            }\n\n            return _context4.abrupt(\"return\");\n\n          case 2:\n            setCouponArray([]);\n            db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).where(\"isRedeemed\", \"==\", true).get().then(function (snap) {\n              snap.forEach(function (doc) {\n                setCouponArray(function (prev) {\n                  return [].concat(_toConsumableArray(prev), [doc.data()]);\n                });\n              });\n            });\n\n          case 4:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  return React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 5\n    }\n  }, React.createElement(StatusBar, {\n    backgroundColor: \"black\",\n    barStyle: \"light-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    style: styles.optionHolder,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    style: [styles.option, currentOption === \"active\" ? styles.optionEnabled : \"\"],\n    onPress: function onPress() {\n      setcurrentOption(\"active\");\n      getActiveCoupons();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }\n  }, \"Active\"), React.createElement(Text, {\n    style: [styles.option, currentOption === \"expired\" ? styles.optionEnabled : \"\"],\n    onPress: function onPress() {\n      setcurrentOption(\"expired\");\n      getExpiredCoupons();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }\n  }, \"Expired\"), React.createElement(Text, {\n    style: [styles.option, currentOption === \"redeemed\" ? styles.optionEnabled : \"\"],\n    onPress: function onPress() {\n      setcurrentOption(\"redeemed\");\n      getRedeemedCoupons();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 9\n    }\n  }, \"Redeemed\"), React.createElement(Text, {\n    style: [styles.option, currentOption === \"all\" ? styles.optionEnabled : \"\"],\n    onPress: function onPress() {\n      setcurrentOption(\"all\");\n      getAllCoupons();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 9\n    }\n  }, \"All\")), React.createElement(SafeAreaView, {\n    style: styles.couponHolder,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 7\n    }\n  }, React.createElement(FlatList, {\n    data: couponArray,\n    numColumns: 2,\n    keyExtractor: function keyExtractor(item) {\n      return item.id;\n    },\n    contentContainerStyle: {\n      alignItems: \"center\"\n    },\n    renderItem: function renderItem(_ref2) {\n      var item = _ref2.item;\n      var amPm = item.activeFromTime <= \"12-00\" ? \"AM\" : \"PM\";\n      var hour = item.activeFromTime.split(\"-\")[0] % 12;\n      var timetoShow = hour + \":\" + item.activeFromTime.split(\"-\")[1];\n      if (item.activeFromTime) return React.createElement(View, {\n        style: styles.coupon,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 17\n        }\n      }, React.createElement(Image, {\n        style: styles.couponImage,\n        source: test,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 19\n        }\n      }), React.createElement(Text, {\n        style: styles.couponTitle,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 19\n        }\n      }, item.clientName), React.createElement(Text, {\n        style: styles.couponId,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 19\n        }\n      }, \"#\" + item.id), React.createElement(Text, {\n        style: styles.couponActiveFrom,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 19\n        }\n      }, \"Active from : \" + item.activeFromDate.replace(/-/g, \"/\") + \" \" + timetoShow + \" \" + amPm), React.createElement(Text, {\n        style: styles.couponActiveFrom,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 19\n        }\n      }, \"Expiry date : \" + item.expiryDate.replace(/-/g, \"/\")), React.createElement(Text, {\n        style: styles.couponDiscount,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 19\n        }\n      }, \"Discount upto : \" + item.userDiscount5 + \"%\"));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 9\n    }\n  })), React.createElement(Button, {\n    title: \"test\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 7\n    }\n  }));\n}\nvar styles = StyleSheet.create({\n  option: {\n    borderRadius: 10,\n    backgroundColor: \"#1b1b1b\",\n    flex: 1,\n    fontFamily: \"Poppins-Light\",\n    margin: 10,\n    fontSize: 12,\n    textAlign: \"center\",\n    color: \"#6e6e6e\",\n    paddingTop: \"3%\"\n  },\n  optionEnabled: {\n    flex: 1.2,\n    backgroundColor: \"#303030\",\n    color: \"#f1f1f1\"\n  },\n  optionHolder: {\n    height: 60,\n    width: \"100%\",\n    flexDirection: \"row\"\n  },\n  couponImage: {\n    height: 100,\n    resizeMode: \"cover\",\n    borderRadius: 5,\n    width: \"100%\"\n  },\n  couponDiscount: {\n    textAlign: \"left\",\n    width: \"100%\",\n    fontFamily: \"Poppins-SemiBold\",\n    color: \"#000000\",\n    fontSize: 12\n  },\n  couponActiveFrom: {\n    textAlign: \"left\",\n    width: \"100%\",\n    fontFamily: \"Poppins-Regular\",\n    color: \"#000000\",\n    fontSize: 10\n  },\n  couponTitle: {\n    textAlign: \"left\",\n    width: \"100%\",\n    fontFamily: \"Poppins-SemiBold\",\n    color: \"#000000\",\n    fontSize: 16\n  },\n  couponId: {\n    textAlign: \"left\",\n    width: \"100%\",\n    fontFamily: \"Poppins-Regular\",\n    color: \"#1b1b1b\",\n    fontSize: 8\n  },\n  flatList: {\n    alignItems: \"center\"\n  },\n  couponHolder: {\n    width: \"100%\",\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"space-around\",\n    backgroundColor: \"black\",\n    paddingTop: 10\n  },\n  coupon: {\n    width: Dimensions.get(\"window\").width * 0.45,\n    marginRight: 0,\n    marginLeft: 10,\n    padding: 10,\n    height: 210,\n    borderRadius: 20,\n    backgroundColor: \"#ffffff\",\n    marginBottom: 10,\n    color: \"black\"\n  },\n  container: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    backgroundColor: \"black\"\n  }\n});","map":{"version":3,"sources":["D:/WorkSpace/Web Projects/Ad-rebate/Screens/Coupon.js"],"names":["React","useContext","useEffect","useState","db","AuthContext","FlatList","test","CouponScreen","navigation","user","couponArray","setCouponArray","currentOption","setcurrentOption","current","Date","collectionGroup","where","uid","parse","get","then","snap","forEach","doc","aa","data","activeFrom","prev","getActiveCoupons","getExpiredCoupons","x","push","expiryDate","getAllCoupons","getRedeemedCoupons","styles","container","optionHolder","option","optionEnabled","couponHolder","item","id","alignItems","amPm","activeFromTime","hour","split","timetoShow","coupon","couponImage","couponTitle","clientName","couponId","couponActiveFrom","activeFromDate","replace","couponDiscount","userDiscount5","StyleSheet","create","borderRadius","backgroundColor","flex","fontFamily","margin","fontSize","textAlign","color","paddingTop","height","width","flexDirection","resizeMode","flatList","justifyContent","Dimensions","marginRight","marginLeft","padding","marginBottom"],"mappings":"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","sourcesContent":["import \"react-native-gesture-handler\";\r\nimport React, { useContext, useEffect, useState } from \"react\";\r\nimport {\r\n  Button,\r\n  View,\r\n  Text,\r\n  StyleSheet,\r\n  StatusBar,\r\n  SafeAreaView,\r\n  Image,\r\n  Dimensions,\r\n} from \"react-native\";\r\nimport { db } from \"../firebases\";\r\nimport { AuthContext } from \"../routes/AuthProvider\";\r\nimport { FlatList } from \"react-native-gesture-handler\";\r\nimport test from \"../assets/images/test.jpg\";\r\nexport default function CouponScreen({ navigation }) {\r\n  const { user } = useContext(AuthContext);\r\n  const [couponArray, setCouponArray] = useState([]);\r\n  const [currentOption, setcurrentOption] = useState(\"active\");\r\n\r\n  useEffect(() => {\r\n    if (user) {\r\n      var current = new Date();\r\n      db.collectionGroup(\"Coupons\")\r\n        .where(\"allotedTo\", \"==\", user.uid)\r\n        .where(\"isRedeemed\", \"==\", false)\r\n        .where(\"expiryDateMs\", \">=\", Date.parse(current))\r\n        .get()\r\n        .then((snap) => {\r\n          snap.forEach((doc) => {\r\n            var aa = new Date();\r\n            if (doc.data().activeFrom <= Date.parse(aa))\r\n              setCouponArray((prev) => [...prev, doc.data()]);\r\n          });\r\n        });\r\n    }\r\n  }, [user]);\r\n  // for getting active users\r\n  async function getActiveCoupons() {\r\n    if (currentOption === \"active\") return;\r\n    setCouponArray([]);\r\n    var current = new Date();\r\n    db.collectionGroup(\"Coupons\")\r\n      .where(\"allotedTo\", \"==\", user.uid)\r\n      .where(\"isRedeemed\", \"==\", false)\r\n      .where(\"expiryDateMs\", \">=\", Date.parse(current))\r\n      .get()\r\n      .then((snap) => {\r\n        snap.forEach((doc) => {\r\n          if (doc.data().activeFrom <= Date.parse(current))\r\n            setCouponArray((prev) => [...prev, doc.data()]);\r\n        });\r\n      });\r\n  }\r\n  async function getExpiredCoupons() {\r\n    if (currentOption === \"expired\") return;\r\n    var current = new Date();\r\n    setCouponArray([]);\r\n    db.collectionGroup(\"Coupons\")\r\n      .where(\"allotedTo\", \"==\", user.uid)\r\n      .where(\"isRedeemed\",\"==\",false)\r\n      .get()\r\n      .then((snap) => {\r\n        snap.forEach((doc) => {\r\n          let x = [];\r\n          x.push(doc.data());\r\n          if (doc.data().expiryDate <= Date.parse(current))\r\n            setCouponArray((prev) => [...prev, doc.data()]);\r\n        });\r\n      });\r\n  }\r\n  async function getAllCoupons() {\r\n    if (currentOption === \"all\") return;\r\n    setCouponArray([]);\r\n    db.collectionGroup(\"Coupons\")\r\n      .where(\"allotedTo\", \"==\", user.uid)\r\n      .get()\r\n      .then((snap) => {\r\n        snap.forEach((doc) => {\r\n          setCouponArray((prev) => [...prev, doc.data()]);\r\n        });\r\n      });\r\n  }\r\n  async function getRedeemedCoupons() {\r\n    if (currentOption === \"redeemed\") return;\r\n    setCouponArray([]);\r\n    db.collectionGroup(\"Coupons\")\r\n      .where(\"allotedTo\", \"==\", user.uid)\r\n      .where(\"isRedeemed\", \"==\", true)\r\n      .get()\r\n      .then((snap) => {\r\n        snap.forEach((doc) => {\r\n          setCouponArray((prev) => [...prev, doc.data()]);\r\n        });\r\n      });\r\n  }\r\n  return (\r\n    <View style={styles.container}>\r\n      <StatusBar backgroundColor=\"black\" barStyle=\"light-content\" />\r\n      <View style={styles.optionHolder}>\r\n        <Text\r\n          style={[\r\n            styles.option,\r\n            currentOption === \"active\" ? styles.optionEnabled : \"\",\r\n          ]}\r\n          onPress={() => {\r\n            setcurrentOption(\"active\");\r\n            getActiveCoupons();\r\n          }}\r\n        >\r\n          Active\r\n        </Text>\r\n        <Text\r\n          style={[\r\n            styles.option,\r\n            currentOption === \"expired\" ? styles.optionEnabled : \"\",\r\n          ]}\r\n          onPress={() => {\r\n            setcurrentOption(\"expired\");\r\n            getExpiredCoupons();\r\n          }}\r\n        >\r\n          Expired\r\n        </Text>\r\n        <Text\r\n          style={[\r\n            styles.option,\r\n            currentOption === \"redeemed\" ? styles.optionEnabled : \"\",\r\n          ]}\r\n          onPress={() => {\r\n            setcurrentOption(\"redeemed\");\r\n            getRedeemedCoupons();\r\n          }}\r\n        >\r\n          Redeemed\r\n        </Text>\r\n        <Text\r\n          style={[\r\n            styles.option,\r\n            currentOption === \"all\" ? styles.optionEnabled : \"\",\r\n          ]}\r\n          onPress={() => {\r\n            setcurrentOption(\"all\");\r\n            getAllCoupons();\r\n          }}\r\n        >\r\n          All\r\n        </Text>\r\n      </View>\r\n\r\n      <SafeAreaView style={styles.couponHolder}>\r\n        <FlatList\r\n          data={couponArray}\r\n          numColumns={2}\r\n          keyExtractor={(item) => item.id}\r\n          contentContainerStyle={{ alignItems: \"center\" }}\r\n          renderItem={({ item }) => {\r\n            const amPm = item.activeFromTime <= \"12-00\" ? \"AM\" : \"PM\";\r\n            const hour = item.activeFromTime.split(\"-\")[0] % 12;\r\n            const timetoShow = hour + \":\" + item.activeFromTime.split(\"-\")[1];\r\n            if (item.activeFromTime)\r\n              return (\r\n                <View style={styles.coupon}>\r\n                  <Image style={styles.couponImage} source={test}></Image>\r\n                  <Text style={styles.couponTitle}>{item.clientName}</Text>\r\n                  <Text style={styles.couponId}>{\"#\" + item.id}</Text>\r\n                  <Text style={styles.couponActiveFrom}>\r\n                    {\"Active from : \" +\r\n                      item.activeFromDate.replace(/-/g, \"/\") +\r\n                      \" \" +\r\n                      timetoShow +\r\n                      \" \" +\r\n                      amPm}\r\n                  </Text>\r\n                  <Text style={styles.couponActiveFrom}>\r\n                    {\"Expiry date : \" + item.expiryDate.replace(/-/g, \"/\")}\r\n                  </Text>\r\n                  <Text style={styles.couponDiscount}>\r\n                    {\"Discount upto : \" + item.userDiscount5 + \"%\"}\r\n                  </Text>\r\n                </View>\r\n              );\r\n          }}\r\n        />\r\n      </SafeAreaView>\r\n      <Button title=\"test\" />\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  option: {\r\n    borderRadius: 10,\r\n    backgroundColor: \"#1b1b1b\",\r\n    flex: 1,\r\n    fontFamily: \"Poppins-Light\",\r\n    margin: 10,\r\n    fontSize: 12,\r\n    textAlign: \"center\",\r\n    color: \"#6e6e6e\",\r\n    paddingTop: \"3%\",\r\n  },\r\n  optionEnabled: {\r\n    flex: 1.2,\r\n    backgroundColor: \"#303030\",\r\n    color: \"#f1f1f1\",\r\n  },\r\n  optionHolder: {\r\n    height: 60,\r\n    width: \"100%\",\r\n    flexDirection: \"row\",\r\n  },\r\n\r\n  couponImage: {\r\n    height: 100,\r\n    resizeMode: \"cover\",\r\n    borderRadius: 5,\r\n    width: \"100%\",\r\n  },\r\n  couponDiscount: {\r\n    textAlign: \"left\",\r\n    width: \"100%\",\r\n    fontFamily: \"Poppins-SemiBold\",\r\n    color: \"#000000\",\r\n    fontSize: 12,\r\n  },\r\n  couponActiveFrom: {\r\n    textAlign: \"left\",\r\n    width: \"100%\",\r\n    fontFamily: \"Poppins-Regular\",\r\n    color: \"#000000\",\r\n    fontSize: 10,\r\n  },\r\n  couponTitle: {\r\n    textAlign: \"left\",\r\n    width: \"100%\",\r\n    fontFamily: \"Poppins-SemiBold\",\r\n    color: \"#000000\",\r\n    fontSize: 16,\r\n  },\r\n  couponId: {\r\n    textAlign: \"left\",\r\n    width: \"100%\",\r\n    fontFamily: \"Poppins-Regular\",\r\n    color: \"#1b1b1b\",\r\n    fontSize: 8,\r\n  },\r\n  flatList: {\r\n    alignItems: \"center\",\r\n  },\r\n  couponHolder: {\r\n    width: \"100%\",\r\n    flex: 1,\r\n    alignItems: \"center\",\r\n    justifyContent: \"space-around\",\r\n    backgroundColor: \"black\",\r\n    paddingTop: 10,\r\n  },\r\n  coupon: {\r\n    width: Dimensions.get(\"window\").width * 0.45,\r\n    marginRight: 0,\r\n    marginLeft: 10,\r\n    padding: 10,\r\n    height: 210,\r\n    borderRadius: 20,\r\n    backgroundColor: \"#ffffff\",\r\n    marginBottom: 10,\r\n    color: \"black\",\r\n  },\r\n  container: {\r\n    flex: 1,\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    backgroundColor: \"black\",\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}