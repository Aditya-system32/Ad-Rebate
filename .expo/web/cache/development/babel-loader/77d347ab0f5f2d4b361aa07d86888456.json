{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/run/media/silenttush/Data/WorkSpace/Web Projects/Ad-rebate/Screens/Redeem.js\";\nimport \"react-native-gesture-handler\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport { Picker } from \"@react-native-picker/picker\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport BackHandler from \"react-native-web/dist/exports/BackHandler\";\nimport { db } from \"../firebases\";\nimport { AuthContext } from \"../routes/AuthProvider\";\nimport { TouchableNativeFeedback } from \"react-native-gesture-handler\";\nexport default function RedeemScreen(_ref) {\n  var _this = this;\n\n  var navigation = _ref.navigation,\n      route = _ref.route;\n\n  var _useState = useState(0),\n      _useState2 = _slicedToArray(_useState, 2),\n      userBill = _useState2[0],\n      setUserBill = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      finalBill = _useState4[0],\n      setFinalBill = _useState4[1];\n\n  var _useState5 = useState(true),\n      _useState6 = _slicedToArray(_useState5, 2),\n      disable = _useState6[0],\n      setDisable = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      coupons = _useState8[0],\n      setCoupons = _useState8[1];\n\n  var _useState9 = useState(null),\n      _useState10 = _slicedToArray(_useState9, 2),\n      selectedCoupon = _useState10[0],\n      setSelectedCoupon = _useState10[1];\n\n  var _useState11 = useState(null),\n      _useState12 = _slicedToArray(_useState11, 2),\n      discountGiven = _useState12[0],\n      setdiscountGiven = _useState12[1];\n\n  var _useState13 = useState(null),\n      _useState14 = _slicedToArray(_useState13, 2),\n      moneyToCollect = _useState14[0],\n      setmoneyToCollect = _useState14[1];\n\n  var _useState15 = useState(null),\n      _useState16 = _slicedToArray(_useState15, 2),\n      discoutUserBill = _useState16[0],\n      setDiscountUserBill = _useState16[1];\n\n  var _useContext = useContext(AuthContext),\n      user = _useContext.user,\n      setUserData = _useContext.setUserData,\n      setBannerData = _useContext.setBannerData,\n      userData = _useContext.userData;\n\n  useEffect(function () {\n    var backAction = function backAction() {\n      navigation.goBack();\n      return true;\n    };\n\n    var backHandler = BackHandler.addEventListener(\"hardwareBackPress\", backAction);\n    return function () {\n      backHandler.remove();\n    };\n  }, []);\n  useEffect(function () {\n    console.log(selectedCoupon);\n    if (selectedCoupon === null) return;\n\n    if (userBill <= 99 || userBill === \"\") {\n      setDisable(true);\n    } else if (userBill >= 100 && userBill < 200) {\n      var dis = selectedCoupon.discount1 - selectedCoupon.userDiscount1;\n      setmoneyToCollect(Math.round(userBill * dis / 100));\n      var discount = Math.round(userBill / selectedCoupon.userDiscount1);\n      setdiscountGiven(discount);\n      setFinalBill(Math.round(userBill - discount));\n      setDisable(false);\n    } else if (userBill >= 200 && userBill < 300) {\n      var _dis = selectedCoupon.discount2 - selectedCoupon.userDiscount2;\n\n      setmoneyToCollect(Math.round(userBill * _dis / 100));\n\n      var _discount = Math.round(userBill / selectedCoupon.userDiscount2);\n\n      setdiscountGiven(_discount);\n      setFinalBill(Math.round(userBill - _discount));\n      setDisable(false);\n    } else if (userBill >= 300 && userBill < 400) {\n      var _dis2 = selectedCoupon.discount3 - selectedCoupon.userDiscount3;\n\n      setmoneyToCollect(Math.round(userBill * _dis2 / 100));\n\n      var _discount2 = Math.round(userBill / selectedCoupon.userDiscount3);\n\n      setdiscountGiven(_discount2);\n      setFinalBill(Math.round(userBill - _discount2));\n      setDisable(false);\n    } else if (userBill >= 400 && userBill < 500) {\n      var _dis3 = selectedCoupon.discount4 - selectedCoupon.userDiscount4;\n\n      setmoneyToCollect(Math.round(userBill * _dis3 / 100));\n\n      var _discount3 = Math.round(userBill / selectedCoupon.userDiscount4);\n\n      setdiscountGiven(_discount3);\n      setFinalBill(Math.round(userBill - _discount3));\n      setDisable(false);\n    } else if (userBill >= 500) {\n      var _dis4 = selectedCoupon.discount5 - selectedCoupon.userDiscount5;\n\n      setmoneyToCollect(Math.round(userBill * _dis4 / 100));\n\n      var _discount4 = Math.round(userBill / selectedCoupon.userDiscount5);\n\n      setdiscountGiven(_discount4);\n      setFinalBill(Math.round(userBill - _discount4));\n      setDisable(false);\n    }\n  }, [userBill]);\n  useEffect(function () {\n    if (user === null) return;\n\n    function temp() {\n      var current, x, d;\n      return _regeneratorRuntime.async(function temp$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              current = new Date();\n              x = current.getHours() < 10 ? \"0\" : \"\" + current.getHours() + \"-\" + current.getMinutes() < 10 ? \"0\" : \"\" + current.getMinutes();\n              console.log(x);\n              d = (current.getDate() < 10 ? \"0\" : \"\") + current.getDate() + \"-\" + (current.getMonth() + 1 < 10 ? \"0\" : \"\") + (current.getMonth() + 1) + \"-\" + current.getFullYear();\n              db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).where(\"client\", \"==\", route.params.paramKey).where(\"isRedeemed\", \"==\", false).where(\"expiryDateMs\", \">=\", Date.parse(current)).get().then(function (snap) {\n                snap.forEach(function (doc) {\n                  var aa = new Date();\n                  if (doc.data().activeFrom <= Date.parse(aa)) setCoupons(function (prev) {\n                    return [].concat(_toConsumableArray(prev), [doc.data()]);\n                  });\n                });\n              }).catch(function (err) {\n                console.log(err);\n              });\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n\n    temp();\n  }, [user]);\n  useEffect(function () {\n    if (coupons.length < 1) {\n      return;\n    }\n\n    console.log(\"ccc\");\n    console.log(coupons[0]);\n    setSelectedCoupon(coupons[0]);\n  }, [coupons]);\n\n  function handleSubmit() {\n    var current, x, d;\n    return _regeneratorRuntime.async(function handleSubmit$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (!(selectedCoupon === null)) {\n              _context2.next = 3;\n              break;\n            }\n\n            Alert.alert(\"check details again\");\n            return _context2.abrupt(\"return\");\n\n          case 3:\n            current = new Date();\n            x = (current.getHours() < 10 ? \"0\" : \"\") + current.getHours() + \"-\" + (current.getMinutes() < 10 ? \"0\" : \"\") + current.getMinutes();\n            d = (current.getDate() < 10 ? \"0\" : \"\") + current.getDate() + \"-\" + (current.getMonth() + 1 < 10 ? \"0\" : \"\") + (current.getMonth() + 1) + \"-\" + current.getFullYear();\n            db.collection(\"ClientData\").doc(route.params.paramKey).collection(\"Coupons\").doc(selectedCoupon.id).set({\n              isRedeemed: true,\n              action: \"Redeemed\",\n              moneyToCollect: moneyToCollect,\n              discountGiven: discountGiven,\n              userBill: userBill,\n              dateRedeemed: d,\n              timeRedeemed: x\n            }, {\n              merge: true\n            }).then(function () {\n              db.collection(\"Users\").doc(user.uid).collection(\"Transactions\").add({\n                action: \"Redeemed\",\n                clientName: route.params.paramKey,\n                couponId: selectedCoupon.id,\n                dateRedeemed: d,\n                discount: discountGiven,\n                timeRedeemed: x\n              }).catch(function (err) {\n                console.log(err);\n              });\n            }).then(function () {\n              return navigation.replace(\"CouponRedeemed\", {\n                finalBill: finalBill,\n                couponId: selectedCoupon.id,\n                discount: discountGiven,\n                userBill: userBill,\n                client: route.params.paramKey\n              });\n            }).catch(function (err) {\n              return console.log(err);\n            });\n\n          case 7:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  return React.createElement(TouchableWithoutFeedback, {\n    onPress: Keyboard.dismiss,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 5\n    }\n  }, React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 7\n    }\n  }, React.createElement(StatusBar, {\n    backgroundColor: \"black\",\n    barStyle: \"light-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 9\n    }\n  }), React.createElement(TextInput, {\n    style: styles.client,\n    value: route.params.paramKey,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 9\n    }\n  }), coupons.length > 0 ? React.createElement(View, {\n    style: styles.picker,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 11\n    }\n  }, React.createElement(Picker, {\n    style: {\n      color: \"white\",\n      fontSize: 12\n    },\n    dropdownIconColor: \"gray\",\n    onValueChange: function onValueChange(itemValue, itemIndex) {\n      console.log(\"ote,\" + itemValue);\n      setSelectedCoupon(itemValue);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 13\n    }\n  }, coupons.map(function (item) {\n    return React.createElement(Picker.Item, {\n      style: styles.pickerItem,\n      label: item.clientName + \" - discount upto : \" + item.userDiscount5 + \"%\",\n      value: item,\n      key: item.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 19\n      }\n    });\n  }))) : React.createElement(View, {\n    style: styles.err,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    style: {\n      color: \"#920000\",\n      fontFamily: \"Poppins-Regular\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 13\n    }\n  }, \"You do not have any coupon for this store\")), React.createElement(TextInput, {\n    style: styles.client,\n    keyboardType: \"phone-pad\",\n    placeholder: \"Enter bill amount\",\n    placeholderTextColor: \"#dddddd\",\n    onChangeText: function onChangeText(e) {\n      return setUserBill(e);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 9\n    }\n  }), React.createElement(TouchableNativeFeedback, {\n    style: [styles.button, disable ? styles.buttonDisabled : \"\"],\n    disabled: disable,\n    onPress: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    style: {\n      color: \"white\",\n      fontFamily: \"Poppins-Regular\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 11\n    }\n  }, \"Submit\")), React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 9\n    }\n  }, \"Coupons\")));\n}\nvar styles = StyleSheet.create({\n  buttonDisabled: {\n    backgroundColor: \"gray\"\n  },\n  err: {\n    backgroundColor: \"#ff9a9a\",\n    borderRadius: 20,\n    width: \"80%\",\n    height: 50,\n    textAlign: \"center\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    marginBottom: 20\n  },\n  button: {\n    bottom: 0,\n    left: 0,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    borderWidth: 2,\n    borderColor: \"#4b4b4b\",\n    width: 130,\n    marginBottom: 20,\n    height: 50,\n    borderRadius: 50,\n    alignSelf: \"center\",\n    backgroundColor: \"black\"\n  },\n  pickerItem: {\n    color: \"white\",\n    fontFamily: \"Poppins-Regular\",\n    backgroundColor: \"#252525\",\n    borderRadius: 10,\n    width: \"80%\",\n    height: 50,\n    textAlign: \"center\",\n    marginBottom: 10\n  },\n  client: {\n    color: \"white\",\n    fontFamily: \"Poppins-Regular\",\n    backgroundColor: \"#252525\",\n    borderRadius: 20,\n    width: \"80%\",\n    height: 50,\n    textAlign: \"center\",\n    marginBottom: 20\n  },\n  picker: {\n    backgroundColor: \"#252525\",\n    borderColor: \"#424242\",\n    color: \"#ffffff\",\n    borderWidth: 1,\n    borderRadius: 50,\n    paddingLeft: 20,\n    width: \"80%\",\n    height: 50,\n    alignSelf: \"center\",\n    fontSize: 12,\n    fontFamily: \"Poppins-Regular\",\n    marginBottom: 24\n  },\n  container: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    backgroundColor: \"black\"\n  }\n});","map":{"version":3,"sources":["/run/media/silenttush/Data/WorkSpace/Web Projects/Ad-rebate/Screens/Redeem.js"],"names":["React","useContext","useEffect","useState","Picker","db","AuthContext","TouchableNativeFeedback","RedeemScreen","navigation","route","userBill","setUserBill","finalBill","setFinalBill","disable","setDisable","coupons","setCoupons","selectedCoupon","setSelectedCoupon","discountGiven","setdiscountGiven","moneyToCollect","setmoneyToCollect","discoutUserBill","setDiscountUserBill","user","setUserData","setBannerData","userData","backAction","goBack","backHandler","BackHandler","addEventListener","remove","console","log","dis","discount1","userDiscount1","Math","round","discount","discount2","userDiscount2","discount3","userDiscount3","discount4","userDiscount4","discount5","userDiscount5","temp","current","Date","x","getHours","getMinutes","d","getDate","getMonth","getFullYear","collectionGroup","where","uid","params","paramKey","parse","get","then","snap","forEach","doc","aa","data","activeFrom","prev","catch","err","length","handleSubmit","Alert","alert","collection","id","set","isRedeemed","action","dateRedeemed","timeRedeemed","merge","add","clientName","couponId","replace","client","Keyboard","dismiss","styles","container","picker","color","fontSize","itemValue","itemIndex","map","item","pickerItem","fontFamily","e","button","buttonDisabled","StyleSheet","create","backgroundColor","borderRadius","width","height","textAlign","justifyContent","alignItems","marginBottom","bottom","left","borderWidth","borderColor","alignSelf","paddingLeft","flex"],"mappings":"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","sourcesContent":["import \"react-native-gesture-handler\";\r\nimport React, { useContext, useEffect, useState } from \"react\";\r\nimport { Picker } from \"@react-native-picker/picker\";\r\n\r\nimport {\r\n  Button,\r\n  View,\r\n  Text,\r\n  StyleSheet,\r\n  StatusBar,\r\n  TextInput,\r\n  TouchableWithoutFeedback,\r\n  Keyboard,\r\n  Alert,\r\n  BackHandler,\r\n} from \"react-native\";\r\nimport { db } from \"../firebases\";\r\nimport { AuthContext } from \"../routes/AuthProvider\";\r\nimport { TouchableNativeFeedback } from \"react-native-gesture-handler\";\r\nexport default function RedeemScreen({ navigation, route }) {\r\n  const [userBill, setUserBill] = useState(0);\r\n  const [finalBill, setFinalBill] = useState(\"\");\r\n  const [disable, setDisable] = useState(true);\r\n  const [coupons, setCoupons] = useState([]);\r\n  const [selectedCoupon, setSelectedCoupon] = useState(null);\r\n  const [discountGiven, setdiscountGiven] = useState(null);\r\n  const [moneyToCollect, setmoneyToCollect] = useState(null);\r\n  const [discoutUserBill, setDiscountUserBill] = useState(null);\r\n  const { user, setUserData, setBannerData, userData } = useContext(\r\n    AuthContext\r\n  );\r\n  useEffect(() => {\r\n    const backAction = () => {\r\n      navigation.goBack();\r\n      return true;\r\n    };\r\n    const backHandler = BackHandler.addEventListener(\r\n      \"hardwareBackPress\",\r\n      backAction\r\n    );\r\n    return () => {\r\n      backHandler.remove();\r\n    };\r\n  }, []);\r\n  //for bill calc\r\n  useEffect(() => {\r\n    console.log(selectedCoupon);\r\n    if (selectedCoupon === null) return;\r\n    if (userBill <= 99 || userBill === \"\") {\r\n      setDisable(true);\r\n    } else if (userBill >= 100 && userBill < 200) {\r\n      const dis = selectedCoupon.discount1 - selectedCoupon.userDiscount1;\r\n      setmoneyToCollect(Math.round((userBill * dis) / 100));\r\n      const discount = Math.round(userBill / selectedCoupon.userDiscount1);\r\n      setdiscountGiven(discount);\r\n      setFinalBill(Math.round(userBill - discount));\r\n      setDisable(false);\r\n    } else if (userBill >= 200 && userBill < 300) {\r\n      const dis = selectedCoupon.discount2 - selectedCoupon.userDiscount2;\r\n      setmoneyToCollect(Math.round((userBill * dis) / 100));\r\n      const discount = Math.round(userBill / selectedCoupon.userDiscount2);\r\n      setdiscountGiven(discount);\r\n      setFinalBill(Math.round(userBill - discount));\r\n      setDisable(false);\r\n    } else if (userBill >= 300 && userBill < 400) {\r\n      const dis = selectedCoupon.discount3 - selectedCoupon.userDiscount3;\r\n      setmoneyToCollect(Math.round((userBill * dis) / 100));\r\n      const discount = Math.round(userBill / selectedCoupon.userDiscount3);\r\n      setdiscountGiven(discount);\r\n      setFinalBill(Math.round(userBill - discount));\r\n      setDisable(false);\r\n    } else if (userBill >= 400 && userBill < 500) {\r\n      const dis = selectedCoupon.discount4 - selectedCoupon.userDiscount4;\r\n      setmoneyToCollect(Math.round((userBill * dis) / 100));\r\n      const discount = Math.round(userBill / selectedCoupon.userDiscount4);\r\n      setdiscountGiven(discount);\r\n      setFinalBill(Math.round(userBill - discount));\r\n      setDisable(false);\r\n    } else if (userBill >= 500) {\r\n      const dis = selectedCoupon.discount5 - selectedCoupon.userDiscount5;\r\n      setmoneyToCollect(Math.round((userBill * dis) / 100));\r\n      const discount = Math.round(userBill / selectedCoupon.userDiscount5);\r\n      setdiscountGiven(discount);\r\n      setFinalBill(Math.round(userBill - discount));\r\n      setDisable(false);\r\n    }\r\n  }, [userBill]);\r\n  //for getting user coupons\r\n  useEffect(() => {\r\n    if (user === null) return;\r\n    async function temp() {\r\n      var current = new Date();\r\n      const x =\r\n        current.getHours() < 10\r\n          ? \"0\"\r\n          : \"\" + current.getHours() + \"-\" + current.getMinutes() < 10\r\n          ? \"0\"\r\n          : \"\" + current.getMinutes();\r\n      console.log(x);\r\n      const d =\r\n        (current.getDate() < 10 ? \"0\" : \"\") +\r\n        current.getDate() +\r\n        \"-\" +\r\n        (current.getMonth() + 1 < 10 ? \"0\" : \"\") +\r\n        (current.getMonth() + 1) +\r\n        \"-\" +\r\n        current.getFullYear();\r\n      db.collectionGroup(\"Coupons\")\r\n        .where(\"allotedTo\", \"==\", user.uid)\r\n        .where(\"client\", \"==\", route.params.paramKey)\r\n        .where(\"isRedeemed\", \"==\", false)\r\n        .where(\"expiryDateMs\", \">=\", Date.parse(current))\r\n        .get()\r\n        .then((snap) => {\r\n          snap.forEach((doc) => {\r\n            var aa = new Date();\r\n            if (doc.data().activeFrom <= Date.parse(aa))\r\n              setCoupons((prev) => [...prev, doc.data()]);\r\n          });\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n    }\r\n    temp();\r\n  }, [user]);\r\n  useEffect(() => {\r\n    if (coupons.length < 1) {\r\n      return;\r\n    }\r\n    console.log(\"ccc\");\r\n    console.log(coupons[0]);\r\n    setSelectedCoupon(coupons[0]);\r\n  }, [coupons]);\r\n  async function handleSubmit() {\r\n    if (selectedCoupon === null) {\r\n      Alert.alert(\"check details again\");\r\n      return;\r\n    }\r\n    var current = new Date();\r\n    const x =\r\n      (current.getHours() < 10 ? \"0\" : \"\") +\r\n      current.getHours() +\r\n      \"-\" +\r\n      (current.getMinutes() < 10 ? \"0\" : \"\") +\r\n      current.getMinutes();\r\n    const d =\r\n      (current.getDate() < 10 ? \"0\" : \"\") +\r\n      current.getDate() +\r\n      \"-\" +\r\n      (current.getMonth() + 1 < 10 ? \"0\" : \"\") +\r\n      (current.getMonth() + 1) +\r\n      \"-\" +\r\n      current.getFullYear();\r\n    db.collection(\"ClientData\")\r\n      .doc(route.params.paramKey)\r\n      .collection(\"Coupons\")\r\n      .doc(selectedCoupon.id)\r\n      .set(\r\n        {\r\n          isRedeemed: true,\r\n          action: \"Redeemed\",\r\n          moneyToCollect: moneyToCollect,\r\n          discountGiven: discountGiven,\r\n          userBill: userBill,\r\n          dateRedeemed: d,\r\n          timeRedeemed: x,\r\n        },\r\n        { merge: true }\r\n      )\r\n      .then(() => {\r\n        db.collection(\"Users\")\r\n          .doc(user.uid)\r\n          .collection(\"Transactions\")\r\n          .add({\r\n            action: \"Redeemed\",\r\n            clientName: route.params.paramKey,\r\n            couponId: selectedCoupon.id,\r\n            dateRedeemed: d,\r\n            discount: discountGiven,\r\n            timeRedeemed: x,\r\n          })\r\n          .catch((err) => {\r\n            console.log(err);\r\n          });\r\n      })\r\n      .then(() =>\r\n        navigation.replace(\"CouponRedeemed\", {\r\n          finalBill: finalBill,\r\n          couponId: selectedCoupon.id,\r\n          discount: discountGiven,\r\n          userBill: userBill,\r\n          client: route.params.paramKey,\r\n        })\r\n      )\r\n      .catch((err) => console.log(err));\r\n  }\r\n  return (\r\n    <TouchableWithoutFeedback onPress={Keyboard.dismiss}>\r\n      <View style={styles.container}>\r\n        <StatusBar backgroundColor=\"black\" barStyle=\"light-content\" />\r\n        <TextInput\r\n          style={styles.client}\r\n          value={route.params.paramKey}\r\n        ></TextInput>\r\n\r\n        {coupons.length > 0 ? (\r\n          <View style={styles.picker}>\r\n            <Picker\r\n              style={{\r\n                color: \"white\",\r\n                fontSize: 12,\r\n              }}\r\n              dropdownIconColor=\"gray\"\r\n              onValueChange={(itemValue, itemIndex) => {\r\n                console.log(\"ote,\" + itemValue);\r\n                setSelectedCoupon(itemValue);\r\n              }}\r\n            >\r\n              {coupons.map((item) => {\r\n                return (\r\n                  <Picker.Item\r\n                    style={styles.pickerItem}\r\n                    label={\r\n                      item.clientName +\r\n                      \" - discount upto : \" +\r\n                      item.userDiscount5 +\r\n                      \"%\"\r\n                    }\r\n                    value={item}\r\n                    key={item.id}\r\n                  />\r\n                );\r\n              })}\r\n            </Picker>\r\n          </View>\r\n        ) : (\r\n          <View style={styles.err}>\r\n            <Text style={{ color: \"#920000\", fontFamily: \"Poppins-Regular\" }}>\r\n              You do not have any coupon for this store\r\n            </Text>\r\n          </View>\r\n        )}\r\n        <TextInput\r\n          style={styles.client}\r\n          keyboardType=\"phone-pad\"\r\n          placeholder=\"Enter bill amount\"\r\n          placeholderTextColor=\"#dddddd\"\r\n          onChangeText={(e) => setUserBill(e)}\r\n        />\r\n        <TouchableNativeFeedback\r\n          style={[styles.button, disable ? styles.buttonDisabled : \"\"]}\r\n          disabled={disable}\r\n          onPress={handleSubmit}\r\n        >\r\n          <Text style={{ color: \"white\", fontFamily: \"Poppins-Regular\" }}>\r\n            Submit\r\n          </Text>\r\n        </TouchableNativeFeedback>\r\n        <Text>Coupons</Text>\r\n      </View>\r\n    </TouchableWithoutFeedback>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  buttonDisabled: {\r\n    backgroundColor: \"gray\",\r\n  },\r\n  err: {\r\n    backgroundColor: \"#ff9a9a\",\r\n    borderRadius: 20,\r\n    width: \"80%\",\r\n    height: 50,\r\n    textAlign: \"center\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    marginBottom: 20,\r\n  },\r\n  button: {\r\n    bottom: 0,\r\n    left: 0,\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    borderWidth: 2,\r\n    borderColor: \"#4b4b4b\",\r\n    width: 130,\r\n    marginBottom: 20,\r\n    height: 50,\r\n    borderRadius: 50,\r\n    alignSelf: \"center\",\r\n    backgroundColor: \"black\",\r\n  },\r\n  pickerItem: {\r\n    color: \"white\",\r\n    fontFamily: \"Poppins-Regular\",\r\n    backgroundColor: \"#252525\",\r\n    borderRadius: 10,\r\n    width: \"80%\",\r\n    height: 50,\r\n    textAlign: \"center\",\r\n    marginBottom: 10,\r\n  },\r\n  client: {\r\n    color: \"white\",\r\n    fontFamily: \"Poppins-Regular\",\r\n    backgroundColor: \"#252525\",\r\n    borderRadius: 20,\r\n    width: \"80%\",\r\n    height: 50,\r\n    textAlign: \"center\",\r\n    marginBottom: 20,\r\n  },\r\n  picker: {\r\n    backgroundColor: \"#252525\",\r\n    borderColor: \"#424242\",\r\n    color: \"#ffffff\",\r\n    borderWidth: 1,\r\n    borderRadius: 50,\r\n    paddingLeft: 20,\r\n    width: \"80%\",\r\n    height: 50,\r\n    alignSelf: \"center\",\r\n    fontSize: 12,\r\n    fontFamily: \"Poppins-Regular\",\r\n    marginBottom: 24,\r\n  },\r\n  container: {\r\n    flex: 1,\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    backgroundColor: \"black\",\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}