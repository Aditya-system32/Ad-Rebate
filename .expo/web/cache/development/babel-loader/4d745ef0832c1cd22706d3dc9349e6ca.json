{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/run/media/silenttush/Data/WorkSpace/Web Projects/Ad-rebate/Screens/GetCoupon.js\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport BackHandler from \"react-native-web/dist/exports/BackHandler\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport { TouchableNativeFeedback } from \"react-native-gesture-handler\";\nimport test from \"../assets/images/test.jpg\";\nimport { db } from \"../firebases\";\nimport { AuthContext } from \"../routes/AuthProvider\";\nexport default function GetCoupon(_ref) {\n  var _coupon$expiryDate;\n\n  var navigation = _ref.navigation,\n      route = _ref.route;\n  var id = \"chocolateStoryBhilai\";\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      coupon = _useState2[0],\n      setCoupon = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      amPm = _useState4[0],\n      setamPm = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      timetoShow = _useState6[0],\n      settimetoShow = _useState6[1];\n\n  var _useContext = useContext(AuthContext),\n      user = _useContext.user,\n      setUserData = _useContext.setUserData,\n      setBannerData = _useContext.setBannerData,\n      userData = _useContext.userData;\n\n  useEffect(function () {\n    if (coupon === null) return;\n    setamPm(coupon.activeFromTime <= \"12-00\" ? \"AM\" : \"PM\");\n    var hour = coupon.activeFromTime.split(\"-\")[0] % 12;\n    settimetoShow(hour + \":\" + coupon.activeFromTime.split(\"-\")[1]);\n  }, [coupon]);\n  useEffect(function () {\n    var backAction = function backAction() {\n      navigation.popToTop();\n      return true;\n    };\n\n    var backHandler = BackHandler.addEventListener(\"hardwareBackPress\", backAction);\n    return function () {\n      backHandler.remove();\n    };\n  }, []);\n  useEffect(function () {\n    var xx = {};\n\n    function xxx() {\n      return _regeneratorRuntime.async(function xxx$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              db.collection(\"ClientData\").doc(id).collection(\"Coupons\").where(\"isAlloted\", \"==\", false).limit(1).get().then(function (querySnapshot) {\n                querySnapshot.forEach(function (doc) {\n                  xx = doc.data();\n                  console.log(xx);\n                });\n              }).then(function () {\n                var current = new Date();\n                current.setHours(current.getHours() + 1);\n                var x = (current.getHours() < 10 ? \"0\" : \"\") + current.getHours() + \"-\" + (current.getMinutes() < 10 ? \"0\" : \"\") + current.getMinutes();\n                var d = (current.getDate() < 10 ? \"0\" : \"\") + current.getDate() + \"-\" + (current.getMonth() + 1 < 10 ? \"0\" : \"\") + (current.getMonth() + 1) + \"-\" + current.getFullYear();\n                xx.activeFrom = Date.parse(current);\n                xx.activeFromTime = x;\n                xx.activeFromDate = d;\n                xx.isAlloted = true;\n                xx.allotedTo = user.uid;\n                setCoupon(xx);\n                console.log(\"done\");\n                db.collection(\"ClientData\").doc(id).collection(\"Coupons\").doc(xx.id).set(xx).then(function () {\n                  return console.log(\"done\");\n                }).catch(function (err) {\n                  console.log(err);\n                });\n              }).catch(function (error) {\n                console.log(\"Error getting documents: \", error);\n              });\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n\n    xxx();\n  }, []);\n  return React.createElement(View, {\n    style: styles.page,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 5\n    }\n  }, React.createElement(Text, {\n    style: styles.congrats,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }\n  }, \"Congratulations! \"), React.createElement(Text, {\n    style: styles.congrats2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }\n  }, \"coupon recieved\"), React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }\n  }, coupon && coupon.id !== undefined ? React.createElement(View, {\n    style: styles.coupon,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 11\n    }\n  }, React.createElement(Image, {\n    style: styles.couponImage,\n    source: test,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }\n  }), React.createElement(Text, {\n    style: styles.couponTitle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 13\n    }\n  }, coupon.clientName), React.createElement(Text, {\n    style: styles.couponId,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }\n  }, \"#\" + coupon.id), React.createElement(Text, {\n    style: styles.couponActiveFrom,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 13\n    }\n  }, \"Active from : \" + coupon.activeFromDate.replace(/-/g, \"/\") + \" \" + timetoShow + \" \" + amPm), React.createElement(Text, {\n    style: styles.couponActiveFrom,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }\n  }, \"Expiry date : \" + ((_coupon$expiryDate = coupon.expiryDate) == null ? void 0 : _coupon$expiryDate.replace(/-/g, \"/\"))), React.createElement(Text, {\n    style: styles.couponDiscount,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 13\n    }\n  }, \"Discount upto : \" + coupon.userDiscount5 + \"%\")) : React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 11\n    }\n  }, React.createElement(ActivityIndicator, {\n    color: \"white\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }\n  }))), React.createElement(Text, {\n    style: styles.noti,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }\n  }, \"You can only redeem this after an hour\"), React.createElement(TouchableNativeFeedback, {\n    style: styles.gohome,\n    onPress: function onPress() {\n      return navigation.popToTop();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    style: styles.tt,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 9\n    }\n  }, \"Go home\")));\n}\nvar styles = StyleSheet.create({\n  noti: {\n    color: \"#dddddd\",\n    fontFamily: \"Poppins-Regular\",\n    marginBottom: 20,\n    width: \"100%\",\n    backgroundColor: \"rgba(37, 37, 38, 0.5)\",\n    textAlign: \"center\",\n    paddingTop: 5\n  },\n  tt: {\n    color: \"#fff\",\n    width: \"100%\",\n    textAlign: \"center\",\n    fontSize: 16,\n    fontFamily: \"Poppins-Regular\"\n  },\n  gohome: {\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    alignSelf: \"center\",\n    width: 150,\n    borderRadius: 20,\n    marginBottom: 50,\n    height: 58,\n    borderColor: \"#fff\",\n    borderStyle: \"solid\",\n    borderWidth: 1\n  },\n  congrats2: {\n    color: \"#fff\",\n    width: \"100%\",\n    textAlign: \"center\",\n    fontSize: 16,\n    fontFamily: \"Poppins-Regular\"\n  },\n  congrats: {\n    color: \"#46ff83\",\n    width: \"100%\",\n    textAlign: \"center\",\n    marginTop: 70,\n    fontSize: 25,\n    fontFamily: \"Poppins-SemiBold\"\n  },\n  page: {\n    backgroundColor: \"black\",\n    width: \"100%\",\n    height: \"100%\",\n    justifyContent: \"center\"\n  },\n  couponImage: {\n    height: 200,\n    resizeMode: \"cover\",\n    borderRadius: 5,\n    width: \"100%\"\n  },\n  couponDiscount: {\n    textAlign: \"left\",\n    width: \"100%\",\n    fontFamily: \"Poppins-SemiBold\",\n    color: \"#000000\",\n    fontSize: 14\n  },\n  couponActiveFrom: {\n    textAlign: \"left\",\n    width: \"100%\",\n    fontFamily: \"Poppins-Regular\",\n    color: \"#000000\",\n    fontSize: 14\n  },\n  couponTitle: {\n    textAlign: \"left\",\n    width: \"100%\",\n    fontFamily: \"Poppins-SemiBold\",\n    color: \"#000000\",\n    fontSize: 20\n  },\n  couponId: {\n    textAlign: \"left\",\n    width: \"100%\",\n    fontFamily: \"Poppins-Regular\",\n    color: \"#1b1b1b\",\n    fontSize: 12\n  },\n  flatList: {\n    alignItems: \"center\"\n  },\n  couponHolder: {\n    width: \"100%\",\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"space-around\",\n    backgroundColor: \"black\",\n    paddingTop: 10\n  },\n  coupon: {\n    width: Dimensions.get(\"window\").width * 0.65,\n    marginRight: 0,\n    marginTop: 30,\n    marginLeft: 10,\n    padding: 10,\n    height: 350,\n    borderRadius: 20,\n    backgroundColor: \"#f0f0f0\",\n    marginBottom: 10,\n    color: \"black\"\n  },\n  container: {\n    flex: 1,\n    alignItems: \"center\"\n  }\n});","map":{"version":3,"sources":["/run/media/silenttush/Data/WorkSpace/Web Projects/Ad-rebate/Screens/GetCoupon.js"],"names":["React","useContext","useEffect","useState","TouchableNativeFeedback","test","db","AuthContext","GetCoupon","navigation","route","id","coupon","setCoupon","amPm","setamPm","timetoShow","settimetoShow","user","setUserData","setBannerData","userData","activeFromTime","hour","split","backAction","popToTop","backHandler","BackHandler","addEventListener","remove","xx","xxx","collection","doc","where","limit","get","then","querySnapshot","forEach","data","console","log","current","Date","setHours","getHours","x","getMinutes","d","getDate","getMonth","getFullYear","activeFrom","parse","activeFromDate","isAlloted","allotedTo","uid","set","catch","err","error","styles","page","congrats","congrats2","container","undefined","couponImage","couponTitle","clientName","couponId","couponActiveFrom","replace","expiryDate","couponDiscount","userDiscount5","noti","gohome","tt","StyleSheet","create","color","fontFamily","marginBottom","width","backgroundColor","textAlign","paddingTop","fontSize","justifyContent","alignItems","alignSelf","borderRadius","height","borderColor","borderStyle","borderWidth","marginTop","resizeMode","flatList","couponHolder","flex","Dimensions","marginRight","marginLeft","padding"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\r\nimport {\r\n  View,\r\n  Text,\r\n  Button,\r\n  StyleSheet,\r\n  Dimensions,\r\n  BackHandler,\r\n  ActivityIndicator,\r\n  Image,\r\n} from \"react-native\";\r\nimport { TouchableNativeFeedback } from \"react-native-gesture-handler\";\r\nimport test from \"../assets/images/test.jpg\";\r\nimport { db } from \"../firebases\";\r\nimport { AuthContext } from \"../routes/AuthProvider\";\r\nexport default function GetCoupon({ navigation, route }) {\r\n  //const id = route.params.paramKey;\r\n  const id = \"chocolateStoryBhilai\";\r\n  const [coupon, setCoupon] = useState(null);\r\n  const [amPm, setamPm] = useState(null);\r\n  const [timetoShow, settimetoShow] = useState(null);\r\n  const { user, setUserData, setBannerData, userData } = useContext(\r\n    AuthContext\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (coupon === null) return;\r\n    setamPm(coupon.activeFromTime <= \"12-00\" ? \"AM\" : \"PM\");\r\n    const hour = coupon.activeFromTime.split(\"-\")[0] % 12;\r\n    settimetoShow(hour + \":\" + coupon.activeFromTime.split(\"-\")[1]);\r\n  }, [coupon]);\r\n  useEffect(() => {\r\n    const backAction = () => {\r\n      navigation.popToTop();\r\n      return true;\r\n    };\r\n    const backHandler = BackHandler.addEventListener(\r\n      \"hardwareBackPress\",\r\n      backAction\r\n    );\r\n    return () => {\r\n      backHandler.remove();\r\n    };\r\n  }, []);\r\n  useEffect(() => {\r\n    let xx = {};\r\n    async function xxx() {\r\n      db.collection(\"ClientData\")\r\n        .doc(id)\r\n        .collection(\"Coupons\")\r\n        .where(\"isAlloted\", \"==\", false)\r\n        .limit(1)\r\n        .get()\r\n        .then(function (querySnapshot) {\r\n          querySnapshot.forEach(function (doc) {\r\n            // doc.data() is never undefined for query doc snapshots\r\n            xx = doc.data();\r\n            console.log(xx);\r\n          });\r\n        })\r\n        .then(() => {\r\n          var current = new Date();\r\n          current.setHours(current.getHours() + 1);\r\n          const x =\r\n            (current.getHours() < 10 ? \"0\" : \"\") +\r\n            current.getHours() +\r\n            \"-\" +\r\n            (current.getMinutes() < 10 ? \"0\" : \"\") +\r\n            current.getMinutes();\r\n          const d =\r\n            (current.getDate() < 10 ? \"0\" : \"\") +\r\n            current.getDate() +\r\n            \"-\" +\r\n            (current.getMonth() + 1 < 10 ? \"0\" : \"\") +\r\n            (current.getMonth() + 1) +\r\n            \"-\" +\r\n            current.getFullYear();\r\n          xx.activeFrom = Date.parse(current);\r\n          xx.activeFromTime = x;\r\n          xx.activeFromDate = d;\r\n          xx.isAlloted = true;\r\n          xx.allotedTo = user.uid;\r\n          setCoupon(xx);\r\n          console.log(\"done\");\r\n\r\n          db.collection(\"ClientData\")\r\n            .doc(id)\r\n            .collection(\"Coupons\")\r\n            .doc(xx.id)\r\n            .set(xx)\r\n            .then(() => console.log(\"done\"))\r\n            .catch((err) => {\r\n              console.log(err);\r\n            });\r\n        })\r\n        .catch(function (error) {\r\n          console.log(\"Error getting documents: \", error);\r\n        });\r\n    }\r\n    xxx();\r\n  }, []);\r\n\r\n  return (\r\n    <View style={styles.page}>\r\n      <Text style={styles.congrats}>Congratulations! </Text>\r\n      <Text style={styles.congrats2}>coupon recieved</Text>\r\n      <View style={styles.container}>\r\n        {coupon && coupon.id !== undefined ? (\r\n          <View style={styles.coupon}>\r\n            <Image style={styles.couponImage} source={test}></Image>\r\n            <Text style={styles.couponTitle}>{coupon.clientName}</Text>\r\n            <Text style={styles.couponId}>{\"#\" + coupon.id}</Text>\r\n            <Text style={styles.couponActiveFrom}>\r\n              {\"Active from : \" +\r\n                coupon.activeFromDate.replace(/-/g, \"/\") +\r\n                \" \" +\r\n                timetoShow +\r\n                \" \" +\r\n                amPm}\r\n            </Text>\r\n            <Text style={styles.couponActiveFrom}>\r\n              {\"Expiry date : \" + coupon.expiryDate?.replace(/-/g, \"/\")}\r\n            </Text>\r\n            <Text style={styles.couponDiscount}>\r\n              {\"Discount upto : \" + coupon.userDiscount5 + \"%\"}\r\n            </Text>\r\n          </View>\r\n        ) : (\r\n          <View>\r\n            <ActivityIndicator color=\"white\"></ActivityIndicator>\r\n          </View>\r\n        )}\r\n      </View>\r\n      <Text style={styles.noti}>You can only redeem this after an hour</Text>\r\n\r\n      <TouchableNativeFeedback\r\n        style={styles.gohome}\r\n        onPress={() => navigation.popToTop()}\r\n      >\r\n        <Text style={styles.tt}>Go home</Text>\r\n      </TouchableNativeFeedback>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  noti: {\r\n    color: \"#dddddd\",\r\n    fontFamily: \"Poppins-Regular\",\r\n    marginBottom: 20,\r\n    width: \"100%\",\r\n    backgroundColor: \"rgba(37, 37, 38, 0.5)\",\r\n    textAlign: \"center\",\r\n    paddingTop: 5,\r\n  },\r\n  tt: {\r\n    color: \"#fff\",\r\n    width: \"100%\",\r\n    textAlign: \"center\",\r\n    fontSize: 16,\r\n    fontFamily: \"Poppins-Regular\",\r\n  },\r\n  gohome: {\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    alignSelf: \"center\",\r\n    width: 150,\r\n    borderRadius: 20,\r\n    marginBottom: 50,\r\n    height: 58,\r\n    borderColor: \"#fff\",\r\n    borderStyle: \"solid\",\r\n    borderWidth: 1,\r\n  },\r\n  congrats2: {\r\n    color: \"#fff\",\r\n    width: \"100%\",\r\n    textAlign: \"center\",\r\n    fontSize: 16,\r\n    fontFamily: \"Poppins-Regular\",\r\n  },\r\n  congrats: {\r\n    color: \"#46ff83\",\r\n    width: \"100%\",\r\n    textAlign: \"center\",\r\n    marginTop: 70,\r\n    fontSize: 25,\r\n    fontFamily: \"Poppins-SemiBold\",\r\n  },\r\n  page: {\r\n    backgroundColor: \"black\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    justifyContent: \"center\",\r\n  },\r\n  couponImage: {\r\n    height: 200,\r\n    resizeMode: \"cover\",\r\n    borderRadius: 5,\r\n    width: \"100%\",\r\n  },\r\n  couponDiscount: {\r\n    textAlign: \"left\",\r\n    width: \"100%\",\r\n    fontFamily: \"Poppins-SemiBold\",\r\n    color: \"#000000\",\r\n    fontSize: 14,\r\n  },\r\n  couponActiveFrom: {\r\n    textAlign: \"left\",\r\n    width: \"100%\",\r\n    fontFamily: \"Poppins-Regular\",\r\n    color: \"#000000\",\r\n    fontSize: 14,\r\n  },\r\n  couponTitle: {\r\n    textAlign: \"left\",\r\n    width: \"100%\",\r\n    fontFamily: \"Poppins-SemiBold\",\r\n    color: \"#000000\",\r\n    fontSize: 20,\r\n  },\r\n  couponId: {\r\n    textAlign: \"left\",\r\n    width: \"100%\",\r\n    fontFamily: \"Poppins-Regular\",\r\n    color: \"#1b1b1b\",\r\n    fontSize: 12,\r\n  },\r\n  flatList: {\r\n    alignItems: \"center\",\r\n  },\r\n  couponHolder: {\r\n    width: \"100%\",\r\n    flex: 1,\r\n    alignItems: \"center\",\r\n    justifyContent: \"space-around\",\r\n    backgroundColor: \"black\",\r\n    paddingTop: 10,\r\n  },\r\n  coupon: {\r\n    width: Dimensions.get(\"window\").width * 0.65,\r\n    marginRight: 0,\r\n    marginTop: 30,\r\n    marginLeft: 10,\r\n    padding: 10,\r\n    height: 350,\r\n    borderRadius: 20,\r\n    backgroundColor: \"#f0f0f0\",\r\n    marginBottom: 10,\r\n    color: \"black\",\r\n  },\r\n  container: {\r\n    flex: 1,\r\n    alignItems: \"center\",\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}