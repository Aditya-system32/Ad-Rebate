{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/run/media/silenttush/Data/WorkSpace/Web Projects/Ad-rebate/Screens/Coupon.js\";\nimport \"react-native-gesture-handler\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport BackHandler from \"react-native-web/dist/exports/BackHandler\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport { db } from \"../firebases\";\nimport { AuthContext } from \"../routes/AuthProvider\";\nimport { FlatList, TouchableOpacity } from \"react-native-gesture-handler\";\nimport test from \"../assets/images/test.jpg\";\nimport { scaledSize } from \"./Home\";\nexport default function CouponScreen(_ref) {\n  var _this = this;\n\n  var navigation = _ref.navigation;\n\n  var _useContext = useContext(AuthContext),\n      user = _useContext.user;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      couponArray = _useState2[0],\n      setCouponArray = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      showLoadMore = _useState4[0],\n      setShowLoadMore = _useState4[1];\n\n  var _useState5 = useState(\"active\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      currentOption = _useState6[0],\n      setcurrentOption = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      loading = _useState8[0],\n      setLoading = _useState8[1];\n\n  var _useState9 = useState(null),\n      _useState10 = _slicedToArray(_useState9, 2),\n      nextPage = _useState10[0],\n      setNextPage = _useState10[1];\n\n  var _useState11 = useState(undefined),\n      _useState12 = _slicedToArray(_useState11, 2),\n      last = _useState12[0],\n      setlast = _useState12[1];\n\n  useEffect(function () {\n    var backAction = function backAction() {\n      navigation.goBack();\n      return true;\n    };\n\n    var backHandler = BackHandler.addEventListener(\"hardwareBackPress\", backAction);\n    return function () {\n      backHandler.remove();\n    };\n  }, []);\n  useEffect(function () {\n    console.log(showLoadMore);\n  }, [showLoadMore]);\n  useEffect(function () {\n    if (user) {\n      setLoading(true);\n      var current = new Date();\n      db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).where(\"isRedeemed\", \"==\", false).where(\"expiryDateMs\", \">=\", Date.parse(current)).limit(8).get().then(function (snap) {\n        var lastVisible = snap.docs[snap.docs.length - 1];\n        setNextPage(db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).where(\"isRedeemed\", \"==\", false).where(\"expiryDateMs\", \">=\", Date.parse(current)).startAfter(lastVisible).limit(8));\n        snap.forEach(function (doc) {\n          var aa = new Date();\n          if (doc.data().activeFrom <= Date.parse(aa)) setCouponArray(function (prev) {\n            return [].concat(_toConsumableArray(prev), [doc.data()]);\n          });\n        });\n      }).then(function () {\n        setLoading(false);\n      });\n    }\n  }, [user]);\n\n  function nextpageFunction() {\n    var current;\n    return _regeneratorRuntime.async(function nextpageFunction$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            setLoading(true);\n            setCouponArray([]);\n            current = new Date();\n            nextPage.get().then(function (snap) {\n              var lastVisible = snap.docs[snap.docs.length - 1];\n              setNextPage(db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).where(\"isRedeemed\", \"==\", false).where(\"expiryDateMs\", \">=\", Date.parse(current)).startAfter(lastVisible).limit(8));\n              snap.forEach(function (doc) {\n                if (doc.data().activeFrom <= Date.parse(current)) setCouponArray(function (prev) {\n                  return [].concat(_toConsumableArray(prev), [doc.data()]);\n                });\n              });\n              setLoading(false);\n            });\n\n          case 4:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  function getActiveCoupons() {\n    var current;\n    return _regeneratorRuntime.async(function getActiveCoupons$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (!(currentOption === \"active\")) {\n              _context2.next = 2;\n              break;\n            }\n\n            return _context2.abrupt(\"return\");\n\n          case 2:\n            setLoading(true);\n            setCouponArray([]);\n            current = new Date();\n            db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).where(\"isRedeemed\", \"==\", false).where(\"expiryDateMs\", \">=\", Date.parse(current)).limit(8).get().then(function (snap) {\n              var lastVisible = snap.docs[snap.docs.length - 1];\n              setNextPage(db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).where(\"isRedeemed\", \"==\", false).where(\"expiryDateMs\", \">=\", Date.parse(current)).startAfter(lastVisible).limit(8));\n              snap.forEach(function (doc) {\n                if (doc.data().activeFrom <= Date.parse(current)) setCouponArray(function (prev) {\n                  return [].concat(_toConsumableArray(prev), [doc.data()]);\n                });\n              });\n              setLoading(false);\n            });\n\n          case 6:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  function getExpiredCoupons() {\n    var current;\n    return _regeneratorRuntime.async(function getExpiredCoupons$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            if (!(currentOption === \"expired\")) {\n              _context3.next = 2;\n              break;\n            }\n\n            return _context3.abrupt(\"return\");\n\n          case 2:\n            setLoading(true);\n            current = new Date();\n            setCouponArray([]);\n            db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).where(\"isRedeemed\", \"==\", false).limit(8).get().then(function (snap) {\n              var lastVisible = snap.docs[snap.docs.length - 1];\n              setNextPage(db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).where(\"isRedeemed\", \"==\", false).startAfter(lastVisible).limit(8));\n              snap.forEach(function (doc) {\n                var x = [];\n                x.push(doc.data());\n                if (doc.data().expiryDate <= Date.parse(current)) setCouponArray(function (prev) {\n                  return [].concat(_toConsumableArray(prev), [doc.data()]);\n                });\n              });\n              setLoading(false);\n            });\n\n          case 6:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  function getAllCoupons() {\n    return _regeneratorRuntime.async(function getAllCoupons$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            if (!(currentOption === \"all\")) {\n              _context4.next = 2;\n              break;\n            }\n\n            return _context4.abrupt(\"return\");\n\n          case 2:\n            setLoading(true);\n            setCouponArray([]);\n            db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).limit(8).get().then(function (snap) {\n              var lastVisible = snap.docs[snap.docs.length - 1];\n              setNextPage(db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).startAfter(lastVisible).limit(8));\n              snap.forEach(function (doc) {\n                setCouponArray(function (prev) {\n                  return [].concat(_toConsumableArray(prev), [doc.data()]);\n                });\n              });\n              setLoading(false);\n            });\n\n          case 5:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  function getRedeemedCoupons() {\n    return _regeneratorRuntime.async(function getRedeemedCoupons$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            if (!(currentOption === \"redeemed\")) {\n              _context5.next = 2;\n              break;\n            }\n\n            return _context5.abrupt(\"return\");\n\n          case 2:\n            setCouponArray([]);\n            setLoading(true);\n            db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).where(\"isRedeemed\", \"==\", true).limit(8).get().then(function (snap) {\n              var lastVisible = snap.docs[snap.docs.length - 1];\n              setNextPage(db.collectionGroup(\"Coupons\").where(\"allotedTo\", \"==\", user.uid).where(\"isRedeemed\", \"==\", true).startAfter(lastVisible).limit(8));\n              snap.forEach(function (doc) {\n                setCouponArray(function (prev) {\n                  return [].concat(_toConsumableArray(prev), [doc.data()]);\n                });\n              });\n              setLoading(false);\n            });\n\n          case 5:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  return React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 5\n    }\n  }, React.createElement(StatusBar, {\n    backgroundColor: \"black\",\n    barStyle: \"light-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    style: styles.optionHolder,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    style: [styles.option, currentOption === \"active\" ? styles.optionEnabled : \"\"],\n    onPress: function onPress() {\n      setcurrentOption(\"active\");\n      getActiveCoupons();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 9\n    }\n  }, \"Active\"), React.createElement(Text, {\n    style: [styles.option, currentOption === \"expired\" ? styles.optionEnabled : \"\"],\n    onPress: function onPress() {\n      setcurrentOption(\"expired\");\n      getExpiredCoupons();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 9\n    }\n  }, \"Expired\"), React.createElement(Text, {\n    style: [styles.option, currentOption === \"redeemed\" ? styles.optionEnabled : \"\"],\n    onPress: function onPress() {\n      setcurrentOption(\"redeemed\");\n      getRedeemedCoupons();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 9\n    }\n  }, \"Redeemed\"), React.createElement(Text, {\n    style: [styles.option, currentOption === \"all\" ? styles.optionEnabled : \"\"],\n    onPress: function onPress() {\n      setcurrentOption(\"all\");\n      getAllCoupons();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 9\n    }\n  }, \"All\")), React.createElement(SafeAreaView, {\n    style: styles.couponHolder,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 7\n    }\n  }, loading ? React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 11\n    }\n  }, React.createElement(ActivityIndicator, {\n    style: {\n      marginBottom: \"30%\"\n    },\n    color: \"white\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 13\n    }\n  })) : React.createElement(FlatList, {\n    data: couponArray,\n    numColumns: 2,\n    alwaysBounceVertical: true,\n    bounces: true,\n    ListEmptyComponent: React.createElement(Text, {\n      style: {\n        color: \"#ffc8c8\",\n        fontFamily: \"Poppins-Regular\",\n        fontSize: scaledSize(12),\n        alignSelf: \"center\",\n        textAlignVertical: \"center\",\n        marginTop: Dimensions.get(\"screen\").height * 0.38\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 276,\n        columnNumber: 15\n      }\n    }, \"No coupon found.\"),\n    onEndReached: function onEndReached() {\n      return setShowLoadMore(true);\n    },\n    ListFooterComponent: couponArray.length < 8 ? null : React.createElement(TouchableOpacity, {\n      onPress: nextpageFunction,\n      style: styles.loadMore,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 17\n      }\n    }, React.createElement(Text, {\n      style: {\n        color: \"white\",\n        fontFamily: \"Poppins-Regular\",\n        fontSize: scaledSize(15)\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 19\n      }\n    }, \"Load More\")),\n    keyExtractor: function keyExtractor(item) {\n      return item.id;\n    },\n    contentContainerStyle: {\n      alignItems: \"center\"\n    },\n    renderItem: function renderItem(_ref2) {\n      var item = _ref2.item;\n      var amPm = item.activeFromTime <= \"12-00\" ? \"AM\" : \"PM\";\n      var hour = item.activeFromTime.split(\"-\")[0] % 12;\n      var timetoShow = hour + \":\" + item.activeFromTime.split(\"-\")[1];\n      if (item.activeFromTime) return React.createElement(View, {\n        style: styles.coupon,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 19\n        }\n      }, React.createElement(Image, {\n        style: styles.couponImage,\n        source: test,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 21\n        }\n      }), React.createElement(Text, {\n        style: styles.couponTitle,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 318,\n          columnNumber: 21\n        }\n      }, item.clientName), React.createElement(Text, {\n        style: styles.couponId,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 21\n        }\n      }, \"#\" + item.id), React.createElement(Text, {\n        style: styles.couponActiveFrom,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 21\n        }\n      }, \"Active from : \" + item.activeFromDate.replace(/-/g, \"/\") + \" \" + timetoShow + \" \" + amPm), React.createElement(Text, {\n        style: styles.couponActiveFrom,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 21\n        }\n      }, \"Expiry date : \" + item.expiryDate.replace(/-/g, \"/\")), React.createElement(Text, {\n        style: styles.couponDiscount,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 21\n        }\n      }, \"Discount upto : \" + item.userDiscount5 + \"%\"));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 11\n    }\n  })));\n}\nvar styles = StyleSheet.create({\n  loadMore: {\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    alignSelf: \"center\",\n    width: 178,\n    borderRadius: 20,\n    height: 58,\n    borderColor: \"#fff\",\n    borderStyle: \"solid\",\n    borderWidth: 1,\n    marginBottom: 20\n  },\n  option: {\n    borderRadius: 10,\n    backgroundColor: \"#1b1b1b\",\n    flex: 1,\n    fontFamily: \"Poppins-Light\",\n    margin: 10,\n    fontSize: 12,\n    textAlign: \"center\",\n    color: \"#6e6e6e\",\n    paddingTop: \"3%\"\n  },\n  optionEnabled: {\n    flex: 1.2,\n    backgroundColor: \"#303030\",\n    color: \"#f1f1f1\"\n  },\n  optionHolder: {\n    height: 60,\n    width: \"100%\",\n    flexDirection: \"row\"\n  },\n  couponImage: {\n    height: 100,\n    resizeMode: \"cover\",\n    borderRadius: 5,\n    width: \"100%\"\n  },\n  couponDiscount: {\n    textAlign: \"left\",\n    width: \"100%\",\n    fontFamily: \"Poppins-SemiBold\",\n    color: \"#000000\",\n    fontSize: 12\n  },\n  couponActiveFrom: {\n    textAlign: \"left\",\n    width: \"100%\",\n    fontFamily: \"Poppins-Regular\",\n    color: \"#000000\",\n    fontSize: 10\n  },\n  couponTitle: {\n    textAlign: \"left\",\n    width: \"100%\",\n    fontFamily: \"Poppins-SemiBold\",\n    color: \"#000000\",\n    fontSize: 16\n  },\n  couponId: {\n    textAlign: \"left\",\n    width: \"100%\",\n    fontFamily: \"Poppins-Regular\",\n    color: \"#1b1b1b\",\n    fontSize: 8\n  },\n  flatList: {\n    alignItems: \"center\"\n  },\n  couponHolder: {\n    width: \"100%\",\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"space-around\",\n    backgroundColor: \"black\",\n    paddingTop: 10\n  },\n  coupon: {\n    width: Dimensions.get(\"window\").width * 0.45,\n    marginRight: 0,\n    marginLeft: 10,\n    padding: 10,\n    height: 210,\n    borderRadius: 20,\n    backgroundColor: \"#ffffff\",\n    marginBottom: 10,\n    color: \"black\"\n  },\n  container: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    backgroundColor: \"black\"\n  }\n});","map":{"version":3,"sources":["/run/media/silenttush/Data/WorkSpace/Web Projects/Ad-rebate/Screens/Coupon.js"],"names":["React","useContext","useEffect","useState","db","AuthContext","FlatList","TouchableOpacity","test","scaledSize","CouponScreen","navigation","user","couponArray","setCouponArray","showLoadMore","setShowLoadMore","currentOption","setcurrentOption","loading","setLoading","nextPage","setNextPage","undefined","last","setlast","backAction","goBack","backHandler","BackHandler","addEventListener","remove","console","log","current","Date","collectionGroup","where","uid","parse","limit","get","then","snap","lastVisible","docs","length","startAfter","forEach","doc","aa","data","activeFrom","prev","nextpageFunction","getActiveCoupons","getExpiredCoupons","x","push","expiryDate","getAllCoupons","getRedeemedCoupons","styles","container","optionHolder","option","optionEnabled","couponHolder","marginBottom","color","fontFamily","fontSize","alignSelf","textAlignVertical","marginTop","Dimensions","height","loadMore","item","id","alignItems","amPm","activeFromTime","hour","split","timetoShow","coupon","couponImage","couponTitle","clientName","couponId","couponActiveFrom","activeFromDate","replace","couponDiscount","userDiscount5","StyleSheet","create","justifyContent","width","borderRadius","borderColor","borderStyle","borderWidth","backgroundColor","flex","margin","textAlign","paddingTop","flexDirection","resizeMode","flatList","marginRight","marginLeft","padding"],"mappings":";;;;AAAA,OAAO,8BAAP;AACA,OAAOA,KAAP,IAAgBC,UAAhB,EAA4BC,SAA5B,EAAuCC,QAAvC,QAAuD,OAAvD;;;;;;;;;;;AAaA,SAASC,EAAT;AACA,SAASC,WAAT;AACA,SAASC,QAAT,EAAmBC,gBAAnB,QAA2C,8BAA3C;AACA,OAAOC,IAAP;AACA,SAASC,UAAT;AACA,eAAe,SAASC,YAAT,OAAsC;AAAA;;AAAA,MAAdC,UAAc,QAAdA,UAAc;;AAAA,oBAClCV,UAAU,CAACI,WAAD,CADwB;AAAA,MAC3CO,IAD2C,eAC3CA,IAD2C;;AAAA,kBAEbT,QAAQ,CAAC,EAAD,CAFK;AAAA;AAAA,MAE5CU,WAF4C;AAAA,MAE/BC,cAF+B;;AAAA,mBAGXX,QAAQ,CAAC,KAAD,CAHG;AAAA;AAAA,MAG5CY,YAH4C;AAAA,MAG9BC,eAH8B;;AAAA,mBAITb,QAAQ,CAAC,QAAD,CAJC;AAAA;AAAA,MAI5Cc,aAJ4C;AAAA,MAI7BC,gBAJ6B;;AAAA,mBAKrBf,QAAQ,CAAC,KAAD,CALa;AAAA;AAAA,MAK5CgB,OAL4C;AAAA,MAKnCC,UALmC;;AAAA,mBAMnBjB,QAAQ,CAAC,IAAD,CANW;AAAA;AAAA,MAM5CkB,QAN4C;AAAA,MAMlCC,WANkC;;AAAA,oBAO3BnB,QAAQ,CAACoB,SAAD,CAPmB;AAAA;AAAA,MAO5CC,IAP4C;AAAA,MAOtCC,OAPsC;;AAQnDvB,EAAAA,SAAS,CAAC,YAAM;AACd,QAAMwB,UAAU,GAAG,SAAbA,UAAa,GAAM;AACvBf,MAAAA,UAAU,CAACgB,MAAX;AACA,aAAO,IAAP;AACD,KAHD;;AAIA,QAAMC,WAAW,GAAGC,WAAW,CAACC,gBAAZ,CAClB,mBADkB,EAElBJ,UAFkB,CAApB;AAIA,WAAO,YAAM;AACXE,MAAAA,WAAW,CAACG,MAAZ;AACD,KAFD;AAGD,GAZQ,EAYN,EAZM,CAAT;AAcA7B,EAAAA,SAAS,CAAC,YAAM;AACd8B,IAAAA,OAAO,CAACC,GAAR,CAAYlB,YAAZ;AACD,GAFQ,EAEN,CAACA,YAAD,CAFM,CAAT;AAGAb,EAAAA,SAAS,CAAC,YAAM;AACd,QAAIU,IAAJ,EAAU;AACRQ,MAAAA,UAAU,CAAC,IAAD,CAAV;AACA,UAAIc,OAAO,GAAG,IAAIC,IAAJ,EAAd;AACA/B,MAAAA,EAAE,CAACgC,eAAH,CAAmB,SAAnB,EACGC,KADH,CACS,WADT,EACsB,IADtB,EAC4BzB,IAAI,CAAC0B,GADjC,EAEGD,KAFH,CAES,YAFT,EAEuB,IAFvB,EAE6B,KAF7B,EAGGA,KAHH,CAGS,cAHT,EAGyB,IAHzB,EAG+BF,IAAI,CAACI,KAAL,CAAWL,OAAX,CAH/B,EAIGM,KAJH,CAIS,CAJT,EAKGC,GALH,GAMGC,IANH,CAMQ,UAACC,IAAD,EAAU;AACd,YAAIC,WAAW,GAAGD,IAAI,CAACE,IAAL,CAAUF,IAAI,CAACE,IAAL,CAAUC,MAAV,GAAmB,CAA7B,CAAlB;AACAxB,QAAAA,WAAW,CACTlB,EAAE,CACCgC,eADH,CACmB,SADnB,EAEGC,KAFH,CAES,WAFT,EAEsB,IAFtB,EAE4BzB,IAAI,CAAC0B,GAFjC,EAGGD,KAHH,CAGS,YAHT,EAGuB,IAHvB,EAG6B,KAH7B,EAIGA,KAJH,CAIS,cAJT,EAIyB,IAJzB,EAI+BF,IAAI,CAACI,KAAL,CAAWL,OAAX,CAJ/B,EAKGa,UALH,CAKcH,WALd,EAMGJ,KANH,CAMS,CANT,CADS,CAAX;AASAG,QAAAA,IAAI,CAACK,OAAL,CAAa,UAACC,GAAD,EAAS;AACpB,cAAIC,EAAE,GAAG,IAAIf,IAAJ,EAAT;AACA,cAAIc,GAAG,CAACE,IAAJ,GAAWC,UAAX,IAAyBjB,IAAI,CAACI,KAAL,CAAWW,EAAX,CAA7B,EACEpC,cAAc,CAAC,UAACuC,IAAD;AAAA,gDAAcA,IAAd,IAAoBJ,GAAG,CAACE,IAAJ,EAApB;AAAA,WAAD,CAAd;AACH,SAJD;AAKD,OAtBH,EAuBGT,IAvBH,CAuBQ,YAAM;AACVtB,QAAAA,UAAU,CAAC,KAAD,CAAV;AACD,OAzBH;AA0BD;AACF,GA/BQ,EA+BN,CAACR,IAAD,CA/BM,CAAT;;AAiCA,WAAe0C,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AACElC,YAAAA,UAAU,CAAC,IAAD,CAAV;AACAN,YAAAA,cAAc,CAAC,EAAD,CAAd;AACIoB,YAAAA,OAHN,GAGgB,IAAIC,IAAJ,EAHhB;AAIEd,YAAAA,QAAQ,CAACoB,GAAT,GAAeC,IAAf,CAAoB,UAACC,IAAD,EAAU;AAC5B,kBAAIC,WAAW,GAAGD,IAAI,CAACE,IAAL,CAAUF,IAAI,CAACE,IAAL,CAAUC,MAAV,GAAmB,CAA7B,CAAlB;AACAxB,cAAAA,WAAW,CACTlB,EAAE,CACCgC,eADH,CACmB,SADnB,EAEGC,KAFH,CAES,WAFT,EAEsB,IAFtB,EAE4BzB,IAAI,CAAC0B,GAFjC,EAGGD,KAHH,CAGS,YAHT,EAGuB,IAHvB,EAG6B,KAH7B,EAIGA,KAJH,CAIS,cAJT,EAIyB,IAJzB,EAI+BF,IAAI,CAACI,KAAL,CAAWL,OAAX,CAJ/B,EAKGa,UALH,CAKcH,WALd,EAMGJ,KANH,CAMS,CANT,CADS,CAAX;AASAG,cAAAA,IAAI,CAACK,OAAL,CAAa,UAACC,GAAD,EAAS;AACpB,oBAAIA,GAAG,CAACE,IAAJ,GAAWC,UAAX,IAAyBjB,IAAI,CAACI,KAAL,CAAWL,OAAX,CAA7B,EACEpB,cAAc,CAAC,UAACuC,IAAD;AAAA,sDAAcA,IAAd,IAAoBJ,GAAG,CAACE,IAAJ,EAApB;AAAA,iBAAD,CAAd;AACH,eAHD;AAIA/B,cAAAA,UAAU,CAAC,KAAD,CAAV;AACD,aAhBD;;AAJF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAuBA,WAAemC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACMtC,aAAa,KAAK,QADxB;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAEEG,YAAAA,UAAU,CAAC,IAAD,CAAV;AACAN,YAAAA,cAAc,CAAC,EAAD,CAAd;AACIoB,YAAAA,OAJN,GAIgB,IAAIC,IAAJ,EAJhB;AAKE/B,YAAAA,EAAE,CAACgC,eAAH,CAAmB,SAAnB,EACGC,KADH,CACS,WADT,EACsB,IADtB,EAC4BzB,IAAI,CAAC0B,GADjC,EAEGD,KAFH,CAES,YAFT,EAEuB,IAFvB,EAE6B,KAF7B,EAGGA,KAHH,CAGS,cAHT,EAGyB,IAHzB,EAG+BF,IAAI,CAACI,KAAL,CAAWL,OAAX,CAH/B,EAIGM,KAJH,CAIS,CAJT,EAKGC,GALH,GAMGC,IANH,CAMQ,UAACC,IAAD,EAAU;AACd,kBAAIC,WAAW,GAAGD,IAAI,CAACE,IAAL,CAAUF,IAAI,CAACE,IAAL,CAAUC,MAAV,GAAmB,CAA7B,CAAlB;AACAxB,cAAAA,WAAW,CACTlB,EAAE,CACCgC,eADH,CACmB,SADnB,EAEGC,KAFH,CAES,WAFT,EAEsB,IAFtB,EAE4BzB,IAAI,CAAC0B,GAFjC,EAGGD,KAHH,CAGS,YAHT,EAGuB,IAHvB,EAG6B,KAH7B,EAIGA,KAJH,CAIS,cAJT,EAIyB,IAJzB,EAI+BF,IAAI,CAACI,KAAL,CAAWL,OAAX,CAJ/B,EAKGa,UALH,CAKcH,WALd,EAMGJ,KANH,CAMS,CANT,CADS,CAAX;AASAG,cAAAA,IAAI,CAACK,OAAL,CAAa,UAACC,GAAD,EAAS;AACpB,oBAAIA,GAAG,CAACE,IAAJ,GAAWC,UAAX,IAAyBjB,IAAI,CAACI,KAAL,CAAWL,OAAX,CAA7B,EACEpB,cAAc,CAAC,UAACuC,IAAD;AAAA,sDAAcA,IAAd,IAAoBJ,GAAG,CAACE,IAAJ,EAApB;AAAA,iBAAD,CAAd;AACH,eAHD;AAIA/B,cAAAA,UAAU,CAAC,KAAD,CAAV;AACD,aAtBH;;AALF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AA6BA,WAAeoC,iBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACMvC,aAAa,KAAK,SADxB;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAEEG,YAAAA,UAAU,CAAC,IAAD,CAAV;AACIc,YAAAA,OAHN,GAGgB,IAAIC,IAAJ,EAHhB;AAIErB,YAAAA,cAAc,CAAC,EAAD,CAAd;AACAV,YAAAA,EAAE,CAACgC,eAAH,CAAmB,SAAnB,EACGC,KADH,CACS,WADT,EACsB,IADtB,EAC4BzB,IAAI,CAAC0B,GADjC,EAEGD,KAFH,CAES,YAFT,EAEuB,IAFvB,EAE6B,KAF7B,EAGGG,KAHH,CAGS,CAHT,EAIGC,GAJH,GAKGC,IALH,CAKQ,UAACC,IAAD,EAAU;AACd,kBAAIC,WAAW,GAAGD,IAAI,CAACE,IAAL,CAAUF,IAAI,CAACE,IAAL,CAAUC,MAAV,GAAmB,CAA7B,CAAlB;AACAxB,cAAAA,WAAW,CACTlB,EAAE,CACCgC,eADH,CACmB,SADnB,EAEGC,KAFH,CAES,WAFT,EAEsB,IAFtB,EAE4BzB,IAAI,CAAC0B,GAFjC,EAGGD,KAHH,CAGS,YAHT,EAGuB,IAHvB,EAG6B,KAH7B,EAIGU,UAJH,CAIcH,WAJd,EAKGJ,KALH,CAKS,CALT,CADS,CAAX;AAQAG,cAAAA,IAAI,CAACK,OAAL,CAAa,UAACC,GAAD,EAAS;AACpB,oBAAIQ,CAAC,GAAG,EAAR;AACAA,gBAAAA,CAAC,CAACC,IAAF,CAAOT,GAAG,CAACE,IAAJ,EAAP;AACA,oBAAIF,GAAG,CAACE,IAAJ,GAAWQ,UAAX,IAAyBxB,IAAI,CAACI,KAAL,CAAWL,OAAX,CAA7B,EACEpB,cAAc,CAAC,UAACuC,IAAD;AAAA,sDAAcA,IAAd,IAAoBJ,GAAG,CAACE,IAAJ,EAApB;AAAA,iBAAD,CAAd;AACH,eALD;AAMA/B,cAAAA,UAAU,CAAC,KAAD,CAAV;AACD,aAtBH;;AALF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AA6BA,WAAewC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA,kBACM3C,aAAa,KAAK,KADxB;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAEEG,YAAAA,UAAU,CAAC,IAAD,CAAV;AACAN,YAAAA,cAAc,CAAC,EAAD,CAAd;AACAV,YAAAA,EAAE,CAACgC,eAAH,CAAmB,SAAnB,EACGC,KADH,CACS,WADT,EACsB,IADtB,EAC4BzB,IAAI,CAAC0B,GADjC,EAEGE,KAFH,CAES,CAFT,EAGGC,GAHH,GAIGC,IAJH,CAIQ,UAACC,IAAD,EAAU;AACd,kBAAIC,WAAW,GAAGD,IAAI,CAACE,IAAL,CAAUF,IAAI,CAACE,IAAL,CAAUC,MAAV,GAAmB,CAA7B,CAAlB;AACAxB,cAAAA,WAAW,CACTlB,EAAE,CACCgC,eADH,CACmB,SADnB,EAEGC,KAFH,CAES,WAFT,EAEsB,IAFtB,EAE4BzB,IAAI,CAAC0B,GAFjC,EAGGS,UAHH,CAGcH,WAHd,EAIGJ,KAJH,CAIS,CAJT,CADS,CAAX;AAOAG,cAAAA,IAAI,CAACK,OAAL,CAAa,UAACC,GAAD,EAAS;AACpBnC,gBAAAA,cAAc,CAAC,UAACuC,IAAD;AAAA,sDAAcA,IAAd,IAAoBJ,GAAG,CAACE,IAAJ,EAApB;AAAA,iBAAD,CAAd;AACD,eAFD;AAGA/B,cAAAA,UAAU,CAAC,KAAD,CAAV;AACD,aAjBH;;AAJF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAuBA,WAAeyC,kBAAf;AAAA;AAAA;AAAA;AAAA;AAAA,kBACM5C,aAAa,KAAK,UADxB;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAEEH,YAAAA,cAAc,CAAC,EAAD,CAAd;AACAM,YAAAA,UAAU,CAAC,IAAD,CAAV;AACAhB,YAAAA,EAAE,CAACgC,eAAH,CAAmB,SAAnB,EACGC,KADH,CACS,WADT,EACsB,IADtB,EAC4BzB,IAAI,CAAC0B,GADjC,EAEGD,KAFH,CAES,YAFT,EAEuB,IAFvB,EAE6B,IAF7B,EAGGG,KAHH,CAGS,CAHT,EAIGC,GAJH,GAKGC,IALH,CAKQ,UAACC,IAAD,EAAU;AACd,kBAAIC,WAAW,GAAGD,IAAI,CAACE,IAAL,CAAUF,IAAI,CAACE,IAAL,CAAUC,MAAV,GAAmB,CAA7B,CAAlB;AACAxB,cAAAA,WAAW,CACTlB,EAAE,CACCgC,eADH,CACmB,SADnB,EAEGC,KAFH,CAES,WAFT,EAEsB,IAFtB,EAE4BzB,IAAI,CAAC0B,GAFjC,EAGGD,KAHH,CAGS,YAHT,EAGuB,IAHvB,EAG6B,IAH7B,EAIGU,UAJH,CAIcH,WAJd,EAKGJ,KALH,CAKS,CALT,CADS,CAAX;AAQAG,cAAAA,IAAI,CAACK,OAAL,CAAa,UAACC,GAAD,EAAS;AACpBnC,gBAAAA,cAAc,CAAC,UAACuC,IAAD;AAAA,sDAAcA,IAAd,IAAoBJ,GAAG,CAACE,IAAJ,EAApB;AAAA,iBAAD,CAAd;AACD,eAFD;AAGA/B,cAAAA,UAAU,CAAC,KAAD,CAAV;AACD,aAnBH;;AAJF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAyBA,SACE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAE0C,MAAM,CAACC,SAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,SAAD;AAAW,IAAA,eAAe,EAAC,OAA3B;AAAmC,IAAA,QAAQ,EAAC,eAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEE,oBAAC,IAAD;AAAM,IAAA,KAAK,EAAED,MAAM,CAACE,YAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,IAAD;AACE,IAAA,KAAK,EAAE,CACLF,MAAM,CAACG,MADF,EAELhD,aAAa,KAAK,QAAlB,GAA6B6C,MAAM,CAACI,aAApC,GAAoD,EAF/C,CADT;AAKE,IAAA,OAAO,EAAE,mBAAM;AACbhD,MAAAA,gBAAgB,CAAC,QAAD,CAAhB;AACAqC,MAAAA,gBAAgB;AACjB,KARH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,EAaE,oBAAC,IAAD;AACE,IAAA,KAAK,EAAE,CACLO,MAAM,CAACG,MADF,EAELhD,aAAa,KAAK,SAAlB,GAA8B6C,MAAM,CAACI,aAArC,GAAqD,EAFhD,CADT;AAKE,IAAA,OAAO,EAAE,mBAAM;AACbhD,MAAAA,gBAAgB,CAAC,SAAD,CAAhB;AACAsC,MAAAA,iBAAiB;AAClB,KARH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAbF,EAyBE,oBAAC,IAAD;AACE,IAAA,KAAK,EAAE,CACLM,MAAM,CAACG,MADF,EAELhD,aAAa,KAAK,UAAlB,GAA+B6C,MAAM,CAACI,aAAtC,GAAsD,EAFjD,CADT;AAKE,IAAA,OAAO,EAAE,mBAAM;AACbhD,MAAAA,gBAAgB,CAAC,UAAD,CAAhB;AACA2C,MAAAA,kBAAkB;AACnB,KARH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAzBF,EAqCE,oBAAC,IAAD;AACE,IAAA,KAAK,EAAE,CACLC,MAAM,CAACG,MADF,EAELhD,aAAa,KAAK,KAAlB,GAA0B6C,MAAM,CAACI,aAAjC,GAAiD,EAF5C,CADT;AAKE,IAAA,OAAO,EAAE,mBAAM;AACbhD,MAAAA,gBAAgB,CAAC,KAAD,CAAhB;AACA0C,MAAAA,aAAa;AACd,KARH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WArCF,CAFF,EAqDE,oBAAC,YAAD;AAAc,IAAA,KAAK,EAAEE,MAAM,CAACK,YAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGhD,OAAO,GACN,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,oBAAC,iBAAD;AACE,IAAA,KAAK,EAAE;AAAEiD,MAAAA,YAAY,EAAE;AAAhB,KADT;AAEE,IAAA,KAAK,EAAC,OAFR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADM,GAQN,oBAAC,QAAD;AACE,IAAA,IAAI,EAAEvD,WADR;AAEE,IAAA,UAAU,EAAE,CAFd;AAGE,IAAA,oBAAoB,EAAE,IAHxB;AAIE,IAAA,OAAO,EAAE,IAJX;AAKE,IAAA,kBAAkB,EAChB,oBAAC,IAAD;AACE,MAAA,KAAK,EAAE;AACLwD,QAAAA,KAAK,EAAE,SADF;AAELC,QAAAA,UAAU,EAAE,iBAFP;AAGLC,QAAAA,QAAQ,EAAE9D,UAAU,CAAC,EAAD,CAHf;AAIL+D,QAAAA,SAAS,EAAE,QAJN;AAKLC,QAAAA,iBAAiB,EAAE,QALd;AAMLC,QAAAA,SAAS,EAAEC,UAAU,CAAClC,GAAX,CAAe,QAAf,EAAyBmC,MAAzB,GAAkC;AANxC,OADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BANJ;AAmBE,IAAA,YAAY,EAAE;AAAA,aAAM5D,eAAe,CAAC,IAAD,CAArB;AAAA,KAnBhB;AAoBE,IAAA,mBAAmB,EACjBH,WAAW,CAACiC,MAAZ,GAAqB,CAArB,GAAyB,IAAzB,GACE,oBAAC,gBAAD;AACE,MAAA,OAAO,EAAEQ,gBADX;AAEE,MAAA,KAAK,EAAEQ,MAAM,CAACe,QAFhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAIE,oBAAC,IAAD;AACE,MAAA,KAAK,EAAE;AACLR,QAAAA,KAAK,EAAE,OADF;AAELC,QAAAA,UAAU,EAAE,iBAFP;AAGLC,QAAAA,QAAQ,EAAE9D,UAAU,CAAC,EAAD;AAHf,OADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAJF,CAtBN;AAsCE,IAAA,YAAY,EAAE,sBAACqE,IAAD;AAAA,aAAUA,IAAI,CAACC,EAAf;AAAA,KAtChB;AAuCE,IAAA,qBAAqB,EAAE;AAAEC,MAAAA,UAAU,EAAE;AAAd,KAvCzB;AAwCE,IAAA,UAAU,EAAE,2BAAc;AAAA,UAAXF,IAAW,SAAXA,IAAW;AACxB,UAAMG,IAAI,GAAGH,IAAI,CAACI,cAAL,IAAuB,OAAvB,GAAiC,IAAjC,GAAwC,IAArD;AACA,UAAMC,IAAI,GAAGL,IAAI,CAACI,cAAL,CAAoBE,KAApB,CAA0B,GAA1B,EAA+B,CAA/B,IAAoC,EAAjD;AACA,UAAMC,UAAU,GAAGF,IAAI,GAAG,GAAP,GAAaL,IAAI,CAACI,cAAL,CAAoBE,KAApB,CAA0B,GAA1B,EAA+B,CAA/B,CAAhC;AACA,UAAIN,IAAI,CAACI,cAAT,EACE,OACE,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAEpB,MAAM,CAACwB,MAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,KAAD;AAAO,QAAA,KAAK,EAAExB,MAAM,CAACyB,WAArB;AAAkC,QAAA,MAAM,EAAE/E,IAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EAEE,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAEsD,MAAM,CAAC0B,WAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAkCV,IAAI,CAACW,UAAvC,CAFF,EAGE,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAE3B,MAAM,CAAC4B,QAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAA+B,MAAMZ,IAAI,CAACC,EAA1C,CAHF,EAIE,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAEjB,MAAM,CAAC6B,gBAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,mBACCb,IAAI,CAACc,cAAL,CAAoBC,OAApB,CAA4B,IAA5B,EAAkC,GAAlC,CADD,GAEC,GAFD,GAGCR,UAHD,GAIC,GAJD,GAKCJ,IANJ,CAJF,EAYE,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAEnB,MAAM,CAAC6B,gBAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,mBAAmBb,IAAI,CAACnB,UAAL,CAAgBkC,OAAhB,CAAwB,IAAxB,EAA8B,GAA9B,CADtB,CAZF,EAeE,oBAAC,IAAD;AAAM,QAAA,KAAK,EAAE/B,MAAM,CAACgC,cAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,qBAAqBhB,IAAI,CAACiB,aAA1B,GAA0C,GAD7C,CAfF,CADF;AAqBH,KAlEH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IATJ,CArDF,CADF;AAuID;AAED,IAAMjC,MAAM,GAAGkC,UAAU,CAACC,MAAX,CAAkB;AAC/BpB,EAAAA,QAAQ,EAAE;AACRqB,IAAAA,cAAc,EAAE,QADR;AAERlB,IAAAA,UAAU,EAAE,QAFJ;AAGRR,IAAAA,SAAS,EAAE,QAHH;AAIR2B,IAAAA,KAAK,EAAE,GAJC;AAKRC,IAAAA,YAAY,EAAE,EALN;AAMRxB,IAAAA,MAAM,EAAE,EANA;AAORyB,IAAAA,WAAW,EAAE,MAPL;AAQRC,IAAAA,WAAW,EAAE,OARL;AASRC,IAAAA,WAAW,EAAE,CATL;AAURnC,IAAAA,YAAY,EAAE;AAVN,GADqB;AAa/BH,EAAAA,MAAM,EAAE;AACNmC,IAAAA,YAAY,EAAE,EADR;AAENI,IAAAA,eAAe,EAAE,SAFX;AAGNC,IAAAA,IAAI,EAAE,CAHA;AAINnC,IAAAA,UAAU,EAAE,eAJN;AAKNoC,IAAAA,MAAM,EAAE,EALF;AAMNnC,IAAAA,QAAQ,EAAE,EANJ;AAONoC,IAAAA,SAAS,EAAE,QAPL;AAQNtC,IAAAA,KAAK,EAAE,SARD;AASNuC,IAAAA,UAAU,EAAE;AATN,GAbuB;AAwB/B1C,EAAAA,aAAa,EAAE;AACbuC,IAAAA,IAAI,EAAE,GADO;AAEbD,IAAAA,eAAe,EAAE,SAFJ;AAGbnC,IAAAA,KAAK,EAAE;AAHM,GAxBgB;AA6B/BL,EAAAA,YAAY,EAAE;AACZY,IAAAA,MAAM,EAAE,EADI;AAEZuB,IAAAA,KAAK,EAAE,MAFK;AAGZU,IAAAA,aAAa,EAAE;AAHH,GA7BiB;AAmC/BtB,EAAAA,WAAW,EAAE;AACXX,IAAAA,MAAM,EAAE,GADG;AAEXkC,IAAAA,UAAU,EAAE,OAFD;AAGXV,IAAAA,YAAY,EAAE,CAHH;AAIXD,IAAAA,KAAK,EAAE;AAJI,GAnCkB;AAyC/BL,EAAAA,cAAc,EAAE;AACda,IAAAA,SAAS,EAAE,MADG;AAEdR,IAAAA,KAAK,EAAE,MAFO;AAGd7B,IAAAA,UAAU,EAAE,kBAHE;AAIdD,IAAAA,KAAK,EAAE,SAJO;AAKdE,IAAAA,QAAQ,EAAE;AALI,GAzCe;AAgD/BoB,EAAAA,gBAAgB,EAAE;AAChBgB,IAAAA,SAAS,EAAE,MADK;AAEhBR,IAAAA,KAAK,EAAE,MAFS;AAGhB7B,IAAAA,UAAU,EAAE,iBAHI;AAIhBD,IAAAA,KAAK,EAAE,SAJS;AAKhBE,IAAAA,QAAQ,EAAE;AALM,GAhDa;AAuD/BiB,EAAAA,WAAW,EAAE;AACXmB,IAAAA,SAAS,EAAE,MADA;AAEXR,IAAAA,KAAK,EAAE,MAFI;AAGX7B,IAAAA,UAAU,EAAE,kBAHD;AAIXD,IAAAA,KAAK,EAAE,SAJI;AAKXE,IAAAA,QAAQ,EAAE;AALC,GAvDkB;AA8D/BmB,EAAAA,QAAQ,EAAE;AACRiB,IAAAA,SAAS,EAAE,MADH;AAERR,IAAAA,KAAK,EAAE,MAFC;AAGR7B,IAAAA,UAAU,EAAE,iBAHJ;AAIRD,IAAAA,KAAK,EAAE,SAJC;AAKRE,IAAAA,QAAQ,EAAE;AALF,GA9DqB;AAqE/BwC,EAAAA,QAAQ,EAAE;AACR/B,IAAAA,UAAU,EAAE;AADJ,GArEqB;AAwE/Bb,EAAAA,YAAY,EAAE;AACZgC,IAAAA,KAAK,EAAE,MADK;AAEZM,IAAAA,IAAI,EAAE,CAFM;AAGZzB,IAAAA,UAAU,EAAE,QAHA;AAIZkB,IAAAA,cAAc,EAAE,cAJJ;AAKZM,IAAAA,eAAe,EAAE,OALL;AAMZI,IAAAA,UAAU,EAAE;AANA,GAxEiB;AAgF/BtB,EAAAA,MAAM,EAAE;AACNa,IAAAA,KAAK,EAAExB,UAAU,CAAClC,GAAX,CAAe,QAAf,EAAyB0D,KAAzB,GAAiC,IADlC;AAENa,IAAAA,WAAW,EAAE,CAFP;AAGNC,IAAAA,UAAU,EAAE,EAHN;AAINC,IAAAA,OAAO,EAAE,EAJH;AAKNtC,IAAAA,MAAM,EAAE,GALF;AAMNwB,IAAAA,YAAY,EAAE,EANR;AAONI,IAAAA,eAAe,EAAE,SAPX;AAQNpC,IAAAA,YAAY,EAAE,EARR;AASNC,IAAAA,KAAK,EAAE;AATD,GAhFuB;AA2F/BN,EAAAA,SAAS,EAAE;AACT0C,IAAAA,IAAI,EAAE,CADG;AAETzB,IAAAA,UAAU,EAAE,QAFH;AAGTkB,IAAAA,cAAc,EAAE,QAHP;AAITM,IAAAA,eAAe,EAAE;AAJR;AA3FoB,CAAlB,CAAf","sourcesContent":["import \"react-native-gesture-handler\";\r\nimport React, { useContext, useEffect, useState } from \"react\";\r\nimport {\r\n  Button,\r\n  View,\r\n  Text,\r\n  StyleSheet,\r\n  StatusBar,\r\n  SafeAreaView,\r\n  Image,\r\n  Dimensions,\r\n  BackHandler,\r\n  ActivityIndicator,\r\n} from \"react-native\";\r\nimport { db } from \"../firebases\";\r\nimport { AuthContext } from \"../routes/AuthProvider\";\r\nimport { FlatList, TouchableOpacity } from \"react-native-gesture-handler\";\r\nimport test from \"../assets/images/test.jpg\";\r\nimport { scaledSize } from \"./Home\";\r\nexport default function CouponScreen({ navigation }) {\r\n  const { user } = useContext(AuthContext);\r\n  const [couponArray, setCouponArray] = useState([]);\r\n  const [showLoadMore, setShowLoadMore] = useState(false);\r\n  const [currentOption, setcurrentOption] = useState(\"active\");\r\n  const [loading, setLoading] = useState(false);\r\n  const [nextPage, setNextPage] = useState(null);\r\n  const [last, setlast] = useState(undefined);\r\n  useEffect(() => {\r\n    const backAction = () => {\r\n      navigation.goBack();\r\n      return true;\r\n    };\r\n    const backHandler = BackHandler.addEventListener(\r\n      \"hardwareBackPress\",\r\n      backAction\r\n    );\r\n    return () => {\r\n      backHandler.remove();\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    console.log(showLoadMore);\r\n  }, [showLoadMore]);\r\n  useEffect(() => {\r\n    if (user) {\r\n      setLoading(true);\r\n      var current = new Date();\r\n      db.collectionGroup(\"Coupons\")\r\n        .where(\"allotedTo\", \"==\", user.uid)\r\n        .where(\"isRedeemed\", \"==\", false)\r\n        .where(\"expiryDateMs\", \">=\", Date.parse(current))\r\n        .limit(8)\r\n        .get()\r\n        .then((snap) => {\r\n          var lastVisible = snap.docs[snap.docs.length - 1];\r\n          setNextPage(\r\n            db\r\n              .collectionGroup(\"Coupons\")\r\n              .where(\"allotedTo\", \"==\", user.uid)\r\n              .where(\"isRedeemed\", \"==\", false)\r\n              .where(\"expiryDateMs\", \">=\", Date.parse(current))\r\n              .startAfter(lastVisible)\r\n              .limit(8)\r\n          );\r\n          snap.forEach((doc) => {\r\n            var aa = new Date();\r\n            if (doc.data().activeFrom <= Date.parse(aa))\r\n              setCouponArray((prev) => [...prev, doc.data()]);\r\n          });\r\n        })\r\n        .then(() => {\r\n          setLoading(false);\r\n        });\r\n    }\r\n  }, [user]);\r\n\r\n  async function nextpageFunction() {\r\n    setLoading(true);\r\n    setCouponArray([]);\r\n    var current = new Date();\r\n    nextPage.get().then((snap) => {\r\n      var lastVisible = snap.docs[snap.docs.length - 1];\r\n      setNextPage(\r\n        db\r\n          .collectionGroup(\"Coupons\")\r\n          .where(\"allotedTo\", \"==\", user.uid)\r\n          .where(\"isRedeemed\", \"==\", false)\r\n          .where(\"expiryDateMs\", \">=\", Date.parse(current))\r\n          .startAfter(lastVisible)\r\n          .limit(8)\r\n      );\r\n      snap.forEach((doc) => {\r\n        if (doc.data().activeFrom <= Date.parse(current))\r\n          setCouponArray((prev) => [...prev, doc.data()]);\r\n      });\r\n      setLoading(false);\r\n    });\r\n  }\r\n  // for getting active users\r\n  async function getActiveCoupons() {\r\n    if (currentOption === \"active\") return;\r\n    setLoading(true);\r\n    setCouponArray([]);\r\n    var current = new Date();\r\n    db.collectionGroup(\"Coupons\")\r\n      .where(\"allotedTo\", \"==\", user.uid)\r\n      .where(\"isRedeemed\", \"==\", false)\r\n      .where(\"expiryDateMs\", \">=\", Date.parse(current))\r\n      .limit(8)\r\n      .get()\r\n      .then((snap) => {\r\n        var lastVisible = snap.docs[snap.docs.length - 1];\r\n        setNextPage(\r\n          db\r\n            .collectionGroup(\"Coupons\")\r\n            .where(\"allotedTo\", \"==\", user.uid)\r\n            .where(\"isRedeemed\", \"==\", false)\r\n            .where(\"expiryDateMs\", \">=\", Date.parse(current))\r\n            .startAfter(lastVisible)\r\n            .limit(8)\r\n        );\r\n        snap.forEach((doc) => {\r\n          if (doc.data().activeFrom <= Date.parse(current))\r\n            setCouponArray((prev) => [...prev, doc.data()]);\r\n        });\r\n        setLoading(false);\r\n      });\r\n  }\r\n  async function getExpiredCoupons() {\r\n    if (currentOption === \"expired\") return;\r\n    setLoading(true);\r\n    var current = new Date();\r\n    setCouponArray([]);\r\n    db.collectionGroup(\"Coupons\")\r\n      .where(\"allotedTo\", \"==\", user.uid)\r\n      .where(\"isRedeemed\", \"==\", false)\r\n      .limit(8)\r\n      .get()\r\n      .then((snap) => {\r\n        var lastVisible = snap.docs[snap.docs.length - 1];\r\n        setNextPage(\r\n          db\r\n            .collectionGroup(\"Coupons\")\r\n            .where(\"allotedTo\", \"==\", user.uid)\r\n            .where(\"isRedeemed\", \"==\", false)\r\n            .startAfter(lastVisible)\r\n            .limit(8)\r\n        );\r\n        snap.forEach((doc) => {\r\n          let x = [];\r\n          x.push(doc.data());\r\n          if (doc.data().expiryDate <= Date.parse(current))\r\n            setCouponArray((prev) => [...prev, doc.data()]);\r\n        });\r\n        setLoading(false);\r\n      });\r\n  }\r\n  async function getAllCoupons() {\r\n    if (currentOption === \"all\") return;\r\n    setLoading(true);\r\n    setCouponArray([]);\r\n    db.collectionGroup(\"Coupons\")\r\n      .where(\"allotedTo\", \"==\", user.uid)\r\n      .limit(8)\r\n      .get()\r\n      .then((snap) => {\r\n        var lastVisible = snap.docs[snap.docs.length - 1];\r\n        setNextPage(\r\n          db\r\n            .collectionGroup(\"Coupons\")\r\n            .where(\"allotedTo\", \"==\", user.uid)\r\n            .startAfter(lastVisible)\r\n            .limit(8)\r\n        );\r\n        snap.forEach((doc) => {\r\n          setCouponArray((prev) => [...prev, doc.data()]);\r\n        });\r\n        setLoading(false);\r\n      });\r\n  }\r\n  async function getRedeemedCoupons() {\r\n    if (currentOption === \"redeemed\") return;\r\n    setCouponArray([]);\r\n    setLoading(true);\r\n    db.collectionGroup(\"Coupons\")\r\n      .where(\"allotedTo\", \"==\", user.uid)\r\n      .where(\"isRedeemed\", \"==\", true)\r\n      .limit(8)\r\n      .get()\r\n      .then((snap) => {\r\n        var lastVisible = snap.docs[snap.docs.length - 1];\r\n        setNextPage(\r\n          db\r\n            .collectionGroup(\"Coupons\")\r\n            .where(\"allotedTo\", \"==\", user.uid)\r\n            .where(\"isRedeemed\", \"==\", true)\r\n            .startAfter(lastVisible)\r\n            .limit(8)\r\n        );\r\n        snap.forEach((doc) => {\r\n          setCouponArray((prev) => [...prev, doc.data()]);\r\n        });\r\n        setLoading(false);\r\n      });\r\n  }\r\n  return (\r\n    <View style={styles.container}>\r\n      <StatusBar backgroundColor=\"black\" barStyle=\"light-content\" />\r\n      <View style={styles.optionHolder}>\r\n        <Text\r\n          style={[\r\n            styles.option,\r\n            currentOption === \"active\" ? styles.optionEnabled : \"\",\r\n          ]}\r\n          onPress={() => {\r\n            setcurrentOption(\"active\");\r\n            getActiveCoupons();\r\n          }}\r\n        >\r\n          Active\r\n        </Text>\r\n        <Text\r\n          style={[\r\n            styles.option,\r\n            currentOption === \"expired\" ? styles.optionEnabled : \"\",\r\n          ]}\r\n          onPress={() => {\r\n            setcurrentOption(\"expired\");\r\n            getExpiredCoupons();\r\n          }}\r\n        >\r\n          Expired\r\n        </Text>\r\n        <Text\r\n          style={[\r\n            styles.option,\r\n            currentOption === \"redeemed\" ? styles.optionEnabled : \"\",\r\n          ]}\r\n          onPress={() => {\r\n            setcurrentOption(\"redeemed\");\r\n            getRedeemedCoupons();\r\n          }}\r\n        >\r\n          Redeemed\r\n        </Text>\r\n        <Text\r\n          style={[\r\n            styles.option,\r\n            currentOption === \"all\" ? styles.optionEnabled : \"\",\r\n          ]}\r\n          onPress={() => {\r\n            setcurrentOption(\"all\");\r\n            getAllCoupons();\r\n          }}\r\n        >\r\n          All\r\n        </Text>\r\n      </View>\r\n\r\n      <SafeAreaView style={styles.couponHolder}>\r\n        {loading ? (\r\n          <View>\r\n            <ActivityIndicator\r\n              style={{ marginBottom: \"30%\" }}\r\n              color=\"white\"\r\n            ></ActivityIndicator>\r\n          </View>\r\n        ) : (\r\n          <FlatList\r\n            data={couponArray}\r\n            numColumns={2}\r\n            alwaysBounceVertical={true}\r\n            bounces={true}\r\n            ListEmptyComponent={\r\n              <Text\r\n                style={{\r\n                  color: \"#ffc8c8\",\r\n                  fontFamily: \"Poppins-Regular\",\r\n                  fontSize: scaledSize(12),\r\n                  alignSelf: \"center\",\r\n                  textAlignVertical: \"center\",\r\n                  marginTop: Dimensions.get(\"screen\").height * 0.38,\r\n                }}\r\n              >\r\n                No coupon found.\r\n              </Text>\r\n            }\r\n            onEndReached={() => setShowLoadMore(true)}\r\n            ListFooterComponent={\r\n              couponArray.length < 8 ? null : (\r\n                <TouchableOpacity\r\n                  onPress={nextpageFunction}\r\n                  style={styles.loadMore}\r\n                >\r\n                  <Text\r\n                    style={{\r\n                      color: \"white\",\r\n                      fontFamily: \"Poppins-Regular\",\r\n                      fontSize: scaledSize(15),\r\n                    }}\r\n                  >\r\n                    Load More\r\n                  </Text>\r\n                </TouchableOpacity>\r\n              )\r\n            }\r\n            keyExtractor={(item) => item.id}\r\n            contentContainerStyle={{ alignItems: \"center\" }}\r\n            renderItem={({ item }) => {\r\n              const amPm = item.activeFromTime <= \"12-00\" ? \"AM\" : \"PM\";\r\n              const hour = item.activeFromTime.split(\"-\")[0] % 12;\r\n              const timetoShow = hour + \":\" + item.activeFromTime.split(\"-\")[1];\r\n              if (item.activeFromTime)\r\n                return (\r\n                  <View style={styles.coupon}>\r\n                    <Image style={styles.couponImage} source={test}></Image>\r\n                    <Text style={styles.couponTitle}>{item.clientName}</Text>\r\n                    <Text style={styles.couponId}>{\"#\" + item.id}</Text>\r\n                    <Text style={styles.couponActiveFrom}>\r\n                      {\"Active from : \" +\r\n                        item.activeFromDate.replace(/-/g, \"/\") +\r\n                        \" \" +\r\n                        timetoShow +\r\n                        \" \" +\r\n                        amPm}\r\n                    </Text>\r\n                    <Text style={styles.couponActiveFrom}>\r\n                      {\"Expiry date : \" + item.expiryDate.replace(/-/g, \"/\")}\r\n                    </Text>\r\n                    <Text style={styles.couponDiscount}>\r\n                      {\"Discount upto : \" + item.userDiscount5 + \"%\"}\r\n                    </Text>\r\n                  </View>\r\n                );\r\n            }}\r\n          />\r\n        )}\r\n      </SafeAreaView>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  loadMore: {\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    alignSelf: \"center\",\r\n    width: 178,\r\n    borderRadius: 20,\r\n    height: 58,\r\n    borderColor: \"#fff\",\r\n    borderStyle: \"solid\",\r\n    borderWidth: 1,\r\n    marginBottom: 20,\r\n  },\r\n  option: {\r\n    borderRadius: 10,\r\n    backgroundColor: \"#1b1b1b\",\r\n    flex: 1,\r\n    fontFamily: \"Poppins-Light\",\r\n    margin: 10,\r\n    fontSize: 12,\r\n    textAlign: \"center\",\r\n    color: \"#6e6e6e\",\r\n    paddingTop: \"3%\",\r\n  },\r\n  optionEnabled: {\r\n    flex: 1.2,\r\n    backgroundColor: \"#303030\",\r\n    color: \"#f1f1f1\",\r\n  },\r\n  optionHolder: {\r\n    height: 60,\r\n    width: \"100%\",\r\n    flexDirection: \"row\",\r\n  },\r\n\r\n  couponImage: {\r\n    height: 100,\r\n    resizeMode: \"cover\",\r\n    borderRadius: 5,\r\n    width: \"100%\",\r\n  },\r\n  couponDiscount: {\r\n    textAlign: \"left\",\r\n    width: \"100%\",\r\n    fontFamily: \"Poppins-SemiBold\",\r\n    color: \"#000000\",\r\n    fontSize: 12,\r\n  },\r\n  couponActiveFrom: {\r\n    textAlign: \"left\",\r\n    width: \"100%\",\r\n    fontFamily: \"Poppins-Regular\",\r\n    color: \"#000000\",\r\n    fontSize: 10,\r\n  },\r\n  couponTitle: {\r\n    textAlign: \"left\",\r\n    width: \"100%\",\r\n    fontFamily: \"Poppins-SemiBold\",\r\n    color: \"#000000\",\r\n    fontSize: 16,\r\n  },\r\n  couponId: {\r\n    textAlign: \"left\",\r\n    width: \"100%\",\r\n    fontFamily: \"Poppins-Regular\",\r\n    color: \"#1b1b1b\",\r\n    fontSize: 8,\r\n  },\r\n  flatList: {\r\n    alignItems: \"center\",\r\n  },\r\n  couponHolder: {\r\n    width: \"100%\",\r\n    flex: 1,\r\n    alignItems: \"center\",\r\n    justifyContent: \"space-around\",\r\n    backgroundColor: \"black\",\r\n    paddingTop: 10,\r\n  },\r\n  coupon: {\r\n    width: Dimensions.get(\"window\").width * 0.45,\r\n    marginRight: 0,\r\n    marginLeft: 10,\r\n    padding: 10,\r\n    height: 210,\r\n    borderRadius: 20,\r\n    backgroundColor: \"#ffffff\",\r\n    marginBottom: 10,\r\n    color: \"black\",\r\n  },\r\n  container: {\r\n    flex: 1,\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    backgroundColor: \"black\",\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}